<!doctype html>
<html lang="en">
<head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <link rel="apple-touch-icon" href="xi_logo.png"/>
  <link rel="stylesheet" href="images.css" />

  <title>FastPass+</title>
  <script>setTimeout(function()  {
//    location.reload();
  }, 300000)</script>
  <style>
    body.compare {
      /*background: url('new.jpg') no-repeat 100px 100px;*/
    }
    @media only screen and (orientation:portrait), only screen and (orientation:landscape) {
      body {
        -webkit-user-select: none;
        -webkit-touch-callout: none;
        -webkit-tap-highlight-color: transparent;
        user-select: none;
        touch-callout: none;
        tap-highlight-color: transparent;
      }
    }
    body {
      /*background: url('bg.png');*/
      margin: 0;
      font: normal 14px/18px 'Helvetica', Arial, sans-serif;
    }

    div.content {
      width: 700px;
      margin-top: 10px;
      margin-bottom: 10px;
      padding-bottom: 10px;
      /*border: 1px solid rgba(81,159, 255, 0.3);*/
      /*background-color: white;*/
      /*background: url('data:image/png;base64,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');*/

    }

  </style>
  <script>
    Array.forEach = Array.forEach || function() {
      Array.prototype.forEach.call(arguments[0], arguments[1]);
    };
    window.touch = 'ontouchstart' in document.documentElement ? 'touchstart' : 'click';
    window.touchEnd = 'ontouchstart' in document.documentElement ? 'touchend' : 'mouseup';
  </script>
</head>
<body class="tip hide_subway_panel" NOTloading="0" guests="1" projected="1">
<!--div class="loading">&nbsp;</div-->
<div id="container">
  <nav>
    <style>
        /* Black Button */

      .button.black {
        display: inline-block;
        /*-webkit-border-radius: 12px;*/
        -webkit-box-shadow: 2px 2px 3px #999;
        border: solid 3px rgb(110,110,110);
        background-image: -webkit-gradient(linear, left top, left bottom, from(rgba(140,140,140,0.7)), color-stop(0.5, rgba(50,50,50,0.75)), color-stop(0.5, rgba(1,1,1,0.9)), to(rgba(50,50,50,0.9)));
        color: #fff;
        text-shadow: #000 0 1px 0;
        font: bold 16px/20px Vag, Helvetica, Sans-serif;
        padding: 9px 11px;
      }
      .button.black:hover, .button.black.hover {
        background-image: -webkit-gradient(linear, left top, left bottom, from(rgba(135,148,203,0.85)), color-stop(0.5, rgba(34,56,159,0.75)), color-stop(0.5, rgba(0,27,145,0.75)), to(rgba(2,59,152,0.65)));
        color: #fff;
        text-shadow: #000 0 1px 0;
        -webkit-box-shadow: inset rgba(207,207,255,0.75) 0 1px 1px;
      }
      .button.white {
        display: inline-block;
        -webkit-border-radius: 12px;
        -webkit-box-shadow: 2px 2px 3px #999;
        border: solid 3px rgb(110,110,110);
        background-image: -webkit-gradient(linear, left top, left bottom, from(rgba(234,234,234,0.90)), color-stop(0.5, rgba(195,195,195,0.70)), color-stop(0.5, rgba(166,166,166,0.70)), to(rgba(167,167,167,0.80)));
        color: #000;
        text-shadow: #fff 0 1px 0;
        font: bold 16px/20px Vag, Helvetica, Sans-serif;
        padding: 20px 0;
      }
      #controls .button.white,
      .bk > .button.white {
        border-radius: 0;
        -webkit-box-shadow: none;
        border: none;
      }
      th.button.white {
       border-radius: 0;
        -webkit-box-shadow: none;
       border: none;
       font: inherit;
       display: table-cell;
       /*border-right: 1px solid rgb(110, 110, 110);*/
        /*padding: 10px 11px;*/
      }
      .button.white:not(.no_hover):hover, .button.white.hover {
        background-image: -webkit-gradient(linear, left top, left bottom, from(rgba(135,148,203,0.85)), color-stop(0.5, rgba(34,56,159,0.75)), color-stop(0.5, rgba(0,27,145,0.75)), to(rgba(2,59,152,0.65)));
        color: #fff;
        text-shadow: #000 0 1px 0;
        -webkit-box-shadow: inset rgba(207,207,255,0.75) 0 1px 1px;
      }

      nav {
        /*background-color: white;*/
        background-image: -webkit-gradient(linear, left bottom, left top, color-stop(0, #4D4D4D), color-stop(1, #000203));
        margin-left: -20px;
        margin-top: -10px;
        margin-bottom: -50px;
        margin-right: -100px;
        box-shadow: 0 4px 8px #555;
        /*display: none;*/
      }
      nav #exec_nav {
        padding-left: 80px !important;
        padding-right: 20px !important;
        width: 135px;
      }
    @-webkit-keyframes rotate {
      from {
        -webkit-transform: rotate(0deg);
      }
      to {
        -webkit-transform: rotate(360deg);
      }
    }
    nav #exec_nav:after {
        content: ' ';
        position: absolute;
        top: 19px;
        left: 15px;
        height: 50px;
        width: 50px;
        border-radius: 50%;
        background: rgb(40, 40, 40) url('xi.png') no-repeat;
    }
      nav a.button.black.selected {
        /*background-image: -webkit-gradient(linear, left top, left bottom, from(rgba(60,60,60,0.7)), color-stop(0.5, rgba(20,20,20,0.75)), color-stop(0.5, rgba(1,1,1,0.9)), to(rgba(7,7,7,0.85)));*/
        /*background-image: -webkit-gradient(linear, left bottom, left top, color-stop(0, #4D4D4D), color-stop(1, #000203));*/
        background: none;
        cursor: default;
        -webkit-box-shadow: none;
      }
      nav a.button.black {
        display: inline-block;
        width: 142px;
        padding: 27px 60px !important;
        border: solid 2px rgb(110,110,110);
        border-right: 1px solid black;
        font-size: 2em;
        box-shadow: none;
      }
      @media only screen and (orientation:portrait), only screen and (orientation:landscape) and (max-device-width:1024) {
        nav a.button.black {
          width: 218px;
        }
      }
      a {
        text-decoration: none;
      }
      #entitlements_nav {
        background: url('nav_ent.png') no-repeat 4% 50%,
        -webkit-gradient(linear, left top, left bottom, from(rgba(140,140,140,0.7)), color-stop(0.5, rgba(50,50,50,0.75)), color-stop(0.5, rgba(1,1,1,0.9)), to(rgba(50,50,50,0.9)));
        /*background: url('nav_ent.png') no-repeat 4% 50%, -webkit-gradient(linear, left bottom, left top, color-stop(0, #000000),color-stop(0.45, #242424),color-stop(0.65, #424242),  color-stop(1, #919191));*/
      }
      #entitlements_nav:hover {
        background: url('nav_ent.png') no-repeat 4% 50%, -webkit-gradient(linear, left top, left bottom, from(rgba(135,148,203,0.85)), color-stop(0.5, rgba(34,56,159,0.75)), color-stop(0.5, rgba(0,27,145,0.75)), to(rgba(2,59,152,0.65)));
      }
      #entitlements_nav.selected, #entitlements_nav.selected:hover,
      #blue_nav.selected, #blue_nav.selected:hover,
      #guest_nav.selected, #guest_nav.selected:hover {
        background: url('nav_ent.png') no-repeat 4% 50%;
        border: none;
        border-bottom: solid 2px rgb(110,110,110);
        border-right: 1px solid black;
        cursor: default;
        -webkit-box-shadow: none;
      }
      #blue_nav.selected, #blue_nav.selected:hover {
        background: url('nav_blue.png') no-repeat 4% 50%;
      }
    #guest_nav {
      width: 132px;
    }
      #blue_nav {
        width: 152px;
        background: url('nav_blue.png') no-repeat 4% 50%,
        -webkit-gradient(linear, left top, left bottom, from(rgba(140,140,140,0.7)), color-stop(0.5, rgba(50,50,50,0.75)), color-stop(0.5, rgba(1,1,1,0.9)), to(rgba(50,50,50,0.9)));
      }
      #blue_nav:hover {
        background: url('nav_blue.png') no-repeat 4% 50%,
        -webkit-gradient(linear, left top, left bottom, from(rgba(135,148,203,0.85)), color-stop(0.5, rgba(34,56,159,0.75)), color-stop(0.5, rgba(0,27,145,0.75)), to(rgba(2,59,152,0.65)));
      }
      #blue_nav.selected, #blue.selected:hover {
        background: url('nav_blue.png') no-repeat 4% 50%;
      }
      #guest_nav.selected, #guest_nav.selected:hover {
        background: url('nav_guest.png') no-repeat 5% 50%;
      }
      #guest_nav {
        background: url('nav_guest.png') no-repeat 5% 50%,
        -webkit-gradient(linear, left top, left bottom, from(rgba(140,140,140,0.7)), color-stop(0.5, rgba(50,50,50,0.75)), color-stop(0.5, rgba(1,1,1,0.9)), to(rgba(50,50,50,0.9)));
      }
      #guest_nav:hover {
        background: url('nav_guest.png') no-repeat 5% 50%,
        -webkit-gradient(linear, left top, left bottom, from(rgba(135,148,203,0.85)), color-stop(0.5, rgba(34,56,159,0.75)), color-stop(0.5, rgba(0,27,145,0.75)), to(rgba(2,59,152,0.65)));
      }
      #guest_nav.selected, #guest_nav.selected:hover {
        background: url('nav_guest.png') no-repeat 5% 50%;
      }
      *[bind] {
        position: relative;
        top: 0;
        left: 0;
      }
      body.tip *[bind]:before {
        /*content: '\25c9';*/
        /*content: '\0aef';*/
        /*content: '\2022';*/
        content: attr(num);
        padding-top: 0.5em;
        padding-left: 0.5em;
        color: yellow;
        text-shadow: 3px 3px 0 rgba(0, 0, 0, 0.8);
        /*background-color: blue;*/
        border-radius: 25px;
        -webkit-text-stroke: 1px solid black;
        /*background-image: -webkit-radial-gradient(50% 50%, circle , #fff 40%,transparent 100%);*/
        /*border: 2px solid white;*/
        /*line-height: 1em;*/
        /*font-size: 0.7em;*/
        /*font-size: 36pt;*/
        font-size: 16pt;
        position: absolute;
        top: -10px;
        width: 2em;
        height: 1.5em;
        margin-bottom: -1em;
        margin-right: -1em;

      }
      *[bind]:hover:before {
        /*content: '\25c9';*/
        content: attr(desc);
        text-shadow: none;
        background: white;
        border-radius: 8px;
        color: black;
        font-size: 12pt;
        height: auto;
        width: 200px;
        z-index: 200;
        left: 20px;
      }
      *[num="9"]:hover:before {
        left: -20px;
      }
      body *[bind]:before,
      div.icon *[bind]:before,
      div.icon *[bind]:hover:before {
        display: none;
      }
    </style>
    <div id="topnav">
      <a id="exec_nav" ondblclick="location.reload();" class="selected button black">Summary</a><a id="entitlements_nav" for="entitlements" class="button black">Entitlements</a><a id="blue_nav" for="blue" class="button black">Blue Lanes</a><a id="guest_nav" for="guest" class="button black" optional="guests">Guests</a>
    </div>
  </nav>
  <div id="content">
    <style>
      @font-face {
        font-family: vag;
        /*src: url('vag.ttf') format('truetype');*/
        src: url('vag.otf');
        font-weight: normal;
        font-style: normal;
      }

    </style>
    <style>
    @media only screen and (orientation:portrait), only screen and (orientation:landscape) {
      body * {
        text-shadow: none !important;
      }
    }
    body.compare #container {
      position: relative;
      top: 300px;
    }
    body.compare #container {
      background: #c5c5c5 url('matte_bg.png');
    }
    body[loading] #container {
      -webkit-transform: translate3d(-4000px, 0, 0);
    }

    body {
      margin: 0 20px 20px;
      background: #c5c5c5 url('matte_bg.png');
    }
    body[loading] {
      /*background: rgb(40, 40, 40);*/
    }
    body[loading] div.loading {
      /*height: 100px;*/
      /*width: 250px;*/
      /*margin-top: -50px;*/
      /*position: absolute;*/
      /*margin-left: -200px;*/
      /*top: 50%;*/
      /*left: 50%;*/
      /*background: -webkit-linear-gradient(right, rgb(40, 40, 40) 0%, transparent 25%), url('xi.png');*/
      /*background-size: 100%, 100px;*/
    }

    div.wrap {
      position: relative;
      left: 0;
      top: 0;
      font-family: vag, sans-serif;
      overflow: hidden;
    }
    /*@media only screen and (max-device-width: 1024px) {*/
      div.wrap {
        top: 60px;
      }
    /*}*/


    div.vag:hover {
      /*opacity: 0;*/
    }

    div.bk {
      background-color: rgb(40, 40, 40);
      /*background: rgb(33, 33, 33) url('bk_noise.png');*/
    }

    div.vag div.col {
      margin-left: 30px;
      margin-right: 30px;
      float: left;
    }

    div.vag div.col:first-of-type {
      margin-left: 40px;
    }

    div.vag div.col:last-of-type {
      margin-left: 15px;
      margin-right: 0;
    }

    div.sunken {
      color: transparent;
      position: relative;
      /*top: -244px;*/
      top: 0;
      /*left: 72px;*/
      left: 0;
      width: 240px;
      height: 240px;
      border-radius: 15px;
      box-shadow: inset 0 0 8px black;
      /*background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#1d1d1d), to(#111111));*/
      background: -webkit-linear-gradient(top left, #1D1D1D 0%, #111111 100%);
      /*background-color: rgb(29, 29, 29);*/
      /*background-color: rgb(17, 17, 17);*/
    }

    div.sunken div.total_participants {
      /*font-weight: bold;*/
      text-align: center;
      padding-top: 1.25em;
      margin: auto;
      height: 1em;
      font-size: 4.5em;
      color: rgb(0, 153, 0);
      text-shadow: 1px 1px 4px black;
    }

    div.sunken div.total_participants label {
      display: block;
      padding-top: 1.65em;
      font-size: 0.225em;
      color: rgb(185, 185, 185);
    }

    div.flipper {
      -webkit-perspective: 10000;
      border-radius: 13px;
      border: 1px solid #616266;
      overflow: hidden;
      font-size: 5em;
      position: relative;
      /*bottom: 201px;*/
      bottom: 0;
      /*left: 116px;*/
      /*left: -100px;*/
      margin: auto;
      width: 155px;
      box-shadow: 0 2px 8px black;
    }
    div.flipper.micro {
      -webkit-transform: scale(0.5);
    }

    div.flipper div.top {
      -webkit-transform-style: preserve-3d;
      -webkit-transform-origin: 0% 100%;
      -webkit-transition: margin .5s ease-in-out;
      /*display: none;*/
      position: absolute;
      bottom: 50px;
      height: 50px;
      width: 159px;
      /*background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#22a825), to(#2a822a));*/
      background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#099C09), to(#0AB80B) /*, color-stop(.6,#09a40a)*/);
      margin-left: -2px;
      margin-right: -2px;
      box-shadow: inset 0 1px 2px #dadada;
      border-radius: 13px 13px 0 0;
    }
    div.flipper.flip div.top + div.top {
    /*div.flipper:hover div.top + div.top {*/
      position: absolute;
      top: 0;
      -webkit-transition: all .5s ease-in-out;
      -webkit-transform: rotatex(-180deg);
    }

    div.flipper div.bottom {
      /*display: none;*/
      height: 50px;
      /*background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#22a825), to(#2a822a));*/
      background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#4dbb4b), to(#0da30e), color-stop(0.3, #3fb43f));
      margin-top: 50px;
      margin-left: -2px;
      margin-right: -2px;
      /*box-shadow: inset 0 1px 2px white;*/
      border-radius: 0 0 13px 13px;
    }

    div.flipper label {
      position: absolute;
      top: 0.88em;
      display: inline-block;
      text-align: center;
      margin: auto;
      width: 155px;
      height: 0.5em;
      font-size: 0.7em;
      color: white;
      /*height: 0.5em;*/
      /*overflow: hidden !important;*/
    }
    div.flipper label + label {
      display: none;
      /*padding-top: 0.25em;*/
      top: 1.26em;
      height: 0.5em;
      overflow: hidden !important;
    }

    div.flipper div.crease {
      position: absolute;
      top: 50%;
      color: transparent;
      height: 1px;
      width: 100%;
      background-color: #616266;
    }

    div.flipper div.crease span.hinge {
      position: absolute;
      top: -2.5px;
      display: inline-block;
      left: 14px;
      height: 2.5px;
      width: 5px;
      border-radius: 2px;
      box-shadow: 0 1px 1px #555;
      border: 1px solid #616266;
      background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#fff), to(#0da30e), color-stop(0.5, #3fb43f));
    }

    div.flipper div.crease span.hinge + span.hinge {
      left: 130px;
    }

    div.flipper hr {
      position: absolute;
      top: -40px;
      -webkit-transition: top 0.1s ease-in;
      height: 2px;
      width: 100%;
      z-index: 1;
    }

    div.flipper:hover hr {
      /*top: 240px;*/
    }
    div#queue_counters {
      position: absolute;
      top: 0;
      left: 0;
      width: 954px;
      z-index: 2300;
      padding-top: 36px;
      padding-left: 80px;
      overflow: hidden;
      background-color: rgb(40, 40, 40);
      -webkit-transform: translate3d(-1040px, 0, 0);
      -webkit-transition: all 0.6s ease-in-out;
    }
    /*div#queue_counters:hover,*/
    div#queue_counters.shown {
      -webkit-transform: translate3d(0, 0, 0);
    }
    div.queue_counter {
      position: relative;
      float: left;
      bottom: 0;
      right: 0;
      height: 130px;
      margin-bottom: 9px;
      width: 300px;
      background: rgb(40, 40, 40) url('logos/pooh.png') no-repeat;
      background-size: 60%;
    }
    div.queue_counter:hover {
      background-color: black;
    }
    div.queue_counter[for='haunted'] {
      background-position: 42% top;
      background-size: 31%;
    }
    div.queue_counter div.flipper {
      position: absolute;
      bottom: 30px;
      right: 0;
      -webkit-transform: scale(0.5);
    }

    div.bk  hr,
    div.guest div.in_queue > hr {
      margin: 40px;
      margin-top: 25px;
      margin-bottom: 25px;
      border: none;
      border-bottom: 1px solid #333;
      color: white;
      height: 2px;
      background: black;
      background: -webkit-gradient(radial, 50% 50%, 0, 50% 50%, 70, from(#000), to(#212121));
    }

    .insetText {
      text-shadow: 0 0 3px #555;
      /*background-color: #666666;
  -webkit-background-clip: text;
  -moz-background-clip: text;
  background-clip: text;
  color: transparent;
  text-shadow: rgba(255,255,255,1.0) 0 3px 3px;*/
      /*color: rgba(0,0,0,0.5);
   text-shadow: 2px 2px 3px rgba(255,255,255,0.8),
   0px 0px 1px rgba(0,0,0,.7);*/
    }
    div.donut {
      height: 246px;
      width: 246px;
    }
    div.donut div.bg {
      height: 244px;
      width: 244px;
    }
    div.donut div.bg canvas {
      height: 244px;
      width: 244px;
    }
    div.donut div.inner_shadow {
      height: 244px;
      width: 244px;
    }
    div.donut div.border {
      height: 243px;
      width: 243px;
    }
    div.donut div.hole {
      margin: 45px;
      height: 156px;
      width: 156px;
    }
    div.donut {
      /*-webkit-transform: scale(0.25);*/
      position: relative;
      top: 0;
      /*left: -233px;*/
      left: 0;
      color: transparent;
      /*background-color: white;*/
    }

    div.donut div.border {
      position: absolute;
      top: -1px;
      left: -1px;
      margin: 1px;
      border-radius: 50%;
      /*background-color: rgb(40, 40, 40);*/
      border: 2px solid rgb(40, 40, 40);
      box-shadow: inset 0 1px 1px #fff, 0 4px 4px #000;
    }

    div.donut div.bg {
      position: absolute;
      top: 0;
      margin: 1px;
      border-radius: 50%;
      /*background-color: white;*/
    }
    /*body div.donut div.bg,*/
    body.alt div.donut div.bg {
      /*background: url('donut_bg.png') white;*/
    }


    div.donut div.inner_shadow {
      position: absolute;
      top: 0;
      margin: 1px;
      border-radius: 50%;
      box-shadow: inset 0 0 10px rgb(40, 40, 40);
    }
    div.donut div.hole {
      position: absolute;
      top: 0;
      border-radius: 50%;
      background-color: rgb(40, 40, 40);
      box-shadow: inset 0 8px 8px #000, inset 0 -1px 2px #fff;
    }

    div.donut div.hole div.values {
      text-align: center;
      padding-top: 1.25em;
      margin: auto;
      height: 1em;
      font-size: 3.25em;
      color: rgb(0, 153, 0);
    }

    div.donut div.hole div.values div {
      font-weight: bold;
      margin-bottom: 0.2em;
      text-shadow: 1px 1px 4px black;
    }
    div.entitlements.col div.donut div.hole div.values div {
      font-weight: normal;
    }

    div.donut div.hole div.values label {
      display: block;
      padding-top: 1.5em;
      font-size: 0.35em;
      color: rgb(185, 185, 185);
    }


    #dozen {
      opacity: 0;
      position: absolute;
      left: 140px;
      top: 15px;
      padding: 30px 10px 30px 60px;
      z-index: -1;
      width: 799px;
      -webkit-transform: translate3d(0, -4000px, 0);
      /*-webkit-transition: opacity 0.4s ease-in-out;*/
    }
    #dozen > h2 {
      margin-top: -0.8em;
      text-align: center;
      margin-left: -88px;
      color: #c5c5c5;
      font-size: 2.2em;
      margin-bottom: 0.5em;
      text-shadow: 1px 1px 4px black;
    }
    #dozen > label {
      position: relative;
      top: 0;
      left: 0;
      text-align: center;
      display: inline-block;
      width: 102px;
      color: #c5c5c5;
      text-shadow: 1px 1px 4px black;
    }

    div.donut {
      /*-webkit-transform: scale(0.35);*/
    }
    #dozen div.donut {
      font-size: 0.3em;
      margin: 1.2em 2.4em;
      height: 82px;
      width: 82px;
    }
    #dozen div.donut div.bg {
      margin-top: 3px;
      height: 81px;
      width: 81px;
    }
    #dozen div.donut div.bg canvas {
      height: 81px;
      width: 81px;
    }
    #dozen div.donut div.inner_shadow {
      box-shadow: inset 0 0 3px rgb(40, 40, 40);
      height: 81px;
      width: 81px;
    }
    #dozen div.donut div.border {
      height: 80px;
      width: 80px;
    }
    #dozen div.donut div.hole {
      margin: 20px 20px 20px 19px;
      height: 46px;
      width: 46px;
      box-shadow: inset 0 2px 2px #000, inset 0 -1px 2px #fff;
   }
    #dozen div.donut div.hole div.values {
      padding-top: 0.95em;
    }

    div.icon div.donut {
      top: -62px;
      -webkit-transform: scale(0.5);
      left: 22px;
      font-size: 0.3em;
      margin: 1.2em 2.4em -41px;
      height: 41px;
      width: 41px;
    }
    div.icon div.donut div.bg {
      margin-top: 3px;
      height: 81px;
      width: 81px;
    }
    div.icon div.donut div.bg canvas {
      margin-top: -1px;
      border-radius: 50%;
      height: 81px;
      width: 81px;
    }
    div.icon div.donut div.inner_shadow {
      box-shadow: inset 0 0 3px rgb(40, 40, 40);
      height: 81px;
      width: 81px;
    }
    div.icon div.donut div.border {
      border: 1px solid #555;
      box-shadow: inset 0 1px 1px #fff, 0 1px 1px #555;
      height: 80px;
      width: 80px;
    }
    div.icon.on div.donut div.border {
      /*border: 1px solid #ccc;*/
      /*box-shadow: inset 0 1px 1px #ccc, 0 1px 1px #fff;*/
    }
    div.icon div.donut div.hole {
      margin: 18px 20px 20px 19px;
      height: 46px;
      width: 46px;
      box-shadow: inset 0 2px 2px #000, inset 0 -1px 2px #fff;
   }
    div.icon.on div.donut div.hole {
      margin: 19px 20px 20px 19px;
      /*box-shadow: inset 0 2px 2px #fff, inset 0 -1px 2px #ccc;*/
   }
    div.icon div.donut div.hole div.values {
      padding-top: 0.95em;
    }
    div.icon div.donut {
      font-size: 0.0003em;
    }


    div.icon div.donut {
      color: transparent !important;
    }
    div.icon div.donut div.hole {
      background: transparent;
    }


    #dozen div.donut {
      cursor: pointer;
      /*-webkit-transform: scale(0.35);*/
      /*height: 95px;*/
      /*width: 110px;*/
    }
    #dozen div.donut div {
      /*background-image: none;*/
    }
    #dozen div.donut div.border {
      box-shadow: inset 0 1px 1px #555, 0 2px 2px #000;
    }

    #dozen div.donut.dim div.bg {
      opacity: 0.022;
    }
    @media only screen and (min-device-width: 1025px) {
      #dozen,
      #dozen div.donut.dim div.bg {
        -webkit-transition: opacity 0.4s ease-in-out;
      }
      #dozen div.donut.dim div.bg {
        opacity: 0.025;
      }
    }
    #dozen div.donut.dim.selectable:hover div.bg {
      opacity: 1;
    }

    #dozen div.donut.future {
      cursor: default;
    }
    #dozen div.donut.future div.bg {
      /*background-image: none;*/
    }
    #dozen div.donut.future div.border,
    #dozen div.donut.future div.inner_shadow,
    #dozen div.donut.future div.bg {
      opacity: 0;
    }
    #dozen div.donut.dim div.hole,
    #dozen div.donut.future div.hole {
      box-shadow: inset 0 2px 2px #000, inset 0 -2px 5px #555;
    }


    #dozen div.donut div.hole {
      -webkit-transition: backgound-color 0.4s ease-in-out;
      /*background: #c5c5c5;*/
      /*background-color: white;*/
    }
    #dozen div.donut.selected,
    #dozen div.donut.selected div.bg {
      opacity: 1;
    }
    #dozen div.donut.selectable:hover div.hole,
    /*#dozen div.donut.selected div.hole {*/
    #dozen div.donut.today div.hole {
      margin-top: 18px;
      background-color: white;
      box-shadow: inset 0 2px 2px #000, inset 0 -1px 2px #fff;
      /*background-color: rgb(40, 40, 40);*/
    }

    #dozen div.donut.selectable:hover div.hole div.values div,
    /*#dozen div.donut.selected div.hole div.values div {*/
    #dozen div.donut.today div.hole div.values div {
      -webkit-transition: color 0.4s ease-in-out;
      color: black;
      text-shadow: none;
    }
    #dozen div.donut div.hole div.values div {
      margin-top: 0.2em;
      font-size: 1.4em;
      color: #cfcfcf;
      /*text-shadow: none;*/
    }
    #dozen div.donut div.hole div.values div span {
      display: none;
    }

    #dozen div.donut > div.values,
    #dozen div.donut div.hole div.values label {
      display: none;
    }
    div.donut div.projected {
      height: 266px;
      width: 266px;
      position: absolute;
      top: -10px;
      left: -10px;
      z-index: 5;
      border: 1px solid transparent;
    }
    div.donut div.projected div.line div.connection,
    div.donut div.projected div.line div.start,
    div.donut div.projected div.line div.end {
      height: 2px;
      width: 8px;
    }
    div.donut div.projected div.line {
      /*border: 1px solid green;*/
      height: 100%;
      width: 12px;
      margin-left: 125px;
    }
    div.donut div.projected div.line div.connection {
      margin-left: 4px;
      height: 42px;
      width: 3px;
      background-color: #090;
    }
    div.donut div.projected div.line div.start,
    div.donut div.projected div.line div.end {
      border: 2px solid #090;
      /*border-radius: 0;*/
      /*background-color: #090;*/
    }
    div.donut div.projected div.line div.start {
      border-radius: 50%;
      height: 8px;
    }
    div.donut div.projected div.line div.start:before {
      content: attr(percent) '%';
      color: #c5c5c5;
      position: absolute;
      top: -25px;
    }
    </style>
    <style>
      div.offersets {
        /*border: 1px solid white;*/
        width: 275px;
      }
      div.entitlements h2,
      div.guest h2,
      div.offersets h2 {
        text-align: center;
        font-size: 3em;
        padding-top: 75px;
        margin-top: -0.2em;
        margin-bottom: 1.46em;
        color: white;
        text-shadow: 1px 1px 4px black;
        background-repeat: no-repeat;
        background-position:  center;
        /*background: url('offer_icon.png') no-repeat center;*/
      }
      /*div.entitlements h2 {
        background: url('ent_icon.png') no-repeat center;
      }
      div.guest h2 {
        background: url('guest_icon.png') no-repeat center;
      }*/
      div.option {
        font-weight: bold;
        color: rgb(185, 185, 185);
        text-shadow: 1px 1px 4px black;
      }
      div.offersets div.offerset div.option div.progress label {
        text-shadow: none !important;
      }
      div.option h3 {
        margin-bottom: 5px;
      }
      div.option h3 span {
        font-size: 1.2em;
        /*color: white;*/
      }
      div.option div.progress,
      div.progress {
        width: 0;
        position: relative;
        bottom: 0;
        height: 10px;
        /*width: 30px !important;*/
        /*background: url('donut_bg.png');/*todo:put back*/
        border-radius: 8px;
        box-shadow: inset 0 2px 8px #aaa;
      }
      div.option div.progress {
        height: 30px;
        width: 61%;
      }

      div.option div.progress div.full,
      div.progress div.full {
        position: absolute;
        bottom: 0;
        height: 10px;
        /*height: 50%;*/
        /*width: 20%;*/
        width: 0;
        /*width: 30px !important;*/
        background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#93ca93), to(#009900), color-stop(0.4,#65ba65));
        border-radius: 8px;
      }
      div.option div.progress div.full {
        height: 30px;
      }
      div.option div.progress label,
      div.progress label {
        white-space: nowrap;
        color: rgb(0, 153, 0);
        position: absolute;
        left: 100%;
        margin-left: 0.4em;
        font-size: 1.8em;
        margin-top: 0.3em;
      }
      body.alt div.option div.progress {
        height: 40px;
        width: 61%;
        /*background: url('donut_bg.png');*/
        border-radius: 8px;
        box-shadow: inset 0 2px 8px #aaa;
      }
      body.alt div.option div.progress div.full {
        height: 40px;
        width: 20%;
        background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#93ca93), to(#009900), color-stop(0.4,#65ba65));
        border-radius: 8px;
      }
      div.donut > div.values {
        position: absolute;
        top: 100%;
      }
      div.donut div.values,
      div.entitlements div.values,
      div.guest div.values {
        font-weight: bold;
        text-align: center;
        text-shadow: 1px 1px 4px black;
      }
      div.guest div.values {
        font-size: 1.2em;
      }

      div.donut div.values,
      div.entitlements div.values,
      div.guest div.values,
      div.offersets div.values {
        color: rgb(185, 185, 185);
        margin-top: 0.8em;
      }
      div.donut div.values span,
      div.entitlements div.values span,
      div.option div.values span {
        /*color: white;*/
        font-size: 1.03em;

      }
      div.entitlements > div.values {
        margin-left: -12px;
        margin-right: -12px;
      }

      div.time_picker {
        float: left;
        width: 108px;
        height: 600px;
        /*background-color: #dadada;*/
      }
      div.time_picker > span.shadow {
        width: 140px;
        position: absolute;
        top: -10px;
        left: -30px;
        height: 680px;
        display: block;
        box-shadow: inset -2px 0 8px #555;
        z-index: -1;
        clip: rect(118px 140px 660px 20px);
      }
      div.time_picker > div {
        border-radius: 0;
        border-top-left-radius: 12px;
        border-bottom-left-radius: 12px;
        margin-left: 0;
        margin-top: -10px;
        padding-top: 78px;
        padding-bottom: 20px;
        /*padding-left: 25px;*/
        text-align: center;
        width: 108px;
        background: transparent no-repeat 50% 30%;
        -webkit-transition: background-color 0.24s ease-out;
      }
      body.alt div.time_picker > div {
        /*background: transparent url('today_off.png') no-repeat 50% 30%;*/
      }
      div.time_picker > div:first-of-type {
        margin-top: 0;
      }
      div.time_picker > div.on {
        background-color: rgb(40, 40, 40);
        /*background-image: url('today_on.png');*/
        color: white;
        box-shadow: -2px 2px 16px #555;
      }
      body.alt div.time_picker > div.on {
        /*background-image: url('today_on.png');*/
      }
      div.time_picker > div[for="yesterday"] {
        /*background-image: url('today_off.png');*/
      }
      div.time_picker > div[for="yesterday"].on {
        /*background-image: url('today_on.png');*/
      }
      /*div.time_picker > div[for="todate"] {
        background-image: url('todate_off.png');
      }
      div.time_picker > div[for="todate"].on {
        background-image: url('todate_on.png');
      }
      div.time_picker > div[for="day"] {
        background-image: url('day_off.png');
      }
      div.time_picker > div[for="day"].on {
        background-image: url('day_on.png');
      }*/
      div.time_picker > hr {
        margin: 0 15px 0 20px;
        border: none;
        border-bottom: 1px solid #cfcfcf;
        color: white;
        height: 1px;
        /*background:black;*/
        background: black -webkit-gradient(radial, 50% 50%, 0, 50% 50%, 50, from(#8a8a8a), to(#cfcfcf));
      }
      div.time_picker > div.on + hr {
        border-bottom-color: transparent;
        background: none;
      }

      div.exec {
        float: left;
        height: 650px;
        width: 906px;
      }
      div#hourly_target,
      div.projected,
      div.in_queue {
        -webkit-transition: opacity 0.5s ease-in-out;
      }
      div.wrap.hide_guests div#hourly_target,
      div.wrap.hide_guests div.projected,
      div[show="hide_guests"] div.projected,
      div.wrap.hide_guests div.in_queue,
      div[show="hide_guests"] div.in_queue {
        opacity: 0;
      }
      div.wrap.dozen #dozen,
      div[show="dozen"] #dozen {
        -webkit-transform: translate3d(0, 0, 10px);
        z-index: 2200 !important;
        opacity: 1;
      }
      @media only screen and (max-device-width: 1024px) {
        div.wrap #dozen,
        #dozen {
          /*visibility: hidden;*/
          /*left: -4000px;*/
          z-index: 2 !important;
          opacity: 1 !important;
        }
        div.wrap.dozen #dozen,
        div[show="dozen"] #dozen {
          left: 140px;
          /*visibility: visible;*/
          z-index: 2;
          opacity: 1;
        }
      }
      div[optional="todate"],
      hr[optional="todate"] {
        display: none !important;
      }
      body[todate] div[optional="todate"],
      body[todate] hr[optional="todate"] {
        display: block !important;
      }
      div[optional="projected"] {
        display: none !important;
      }
      body[projected] div[optional="projected"] {
        display: block !important;
      }
      a[optional="guests"] {
        display: none !important;
      }
      body[guests] a[optional="guests"] {
        display: inline-block !important;
      }
      .pad_scroll {
        overflow-y: scroll;
        -webkit-overflow-scrolling: touch;
      }
      /*
      ::-webkit-scrollbar {
        width:8px;
        height:8px;
        -webkit-border-radius: 4px;
      }

      ::-webkit-scrollbar-track,
      ::-webkit-scrollbar-track-piece {
        background-color:rgb(55, 55, 55);
      }

      ::-webkit-scrollbar-thumb {
        background-color: rgba(0, 0, 0, 1);
        width: 6px;
        height: 6px;
        -webkit-border-radius:4px;
      }
      */


    </style>
    <style>
      #blue div.chart hr{
        visibility: hidden;
      }
    </style>
    <!--<span style="display: inline-block; height: 260px;"><br /></span>-->
    <div class="vag wrap" tab=""  show="guests" style="height: 650px; width: 1014px;">
      <div class="time_picker" style="z-index: 1000;">
        <span class="shadow">&nbsp;</span>
        <div for="today" show="guests" class="on icon"><div></div>Today</div>
        <hr />
        <div for="yesterday" class="icon"><div></div>Yesterday</div>
        <hr />
        <div optional="todate" for="todate" class="NOTon">To date</div>
        <hr optional="todate" />
        <div for="day" show="dozen" class="NOTon">Select date</div>
        <hr />
      </div>
      <div class="exec bk">
        <div class="entitlements col">
          <h2>Entitlements</h2>
          <div class="donut">
            <div class="bg"><canvas></canvas></div>
            <div class="border">border</div>
            <div class="inner_shadow">shadow</div>
            <div class="hole">
              <div class="values"><div num="4" bind="redeemed percent">&nbsp;<span>%</span><label>Redeemed</label></div></div>
            </div>
          </div>
          <div class="values"><span num="2" bind="redeemed">&nbsp;</span> redeemed / <span num="3" bind="selected">&nbsp;</span> selected</div>
          <div class="values"><span bind="total_traffic">&nbsp;</span> total traffic</div>
          <hr />
          <div class="micro" id="hourly_target">
            <div class="chart vertical">
              <div class="columns" id="hourly">
                <div class="column" for="0800"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">08<i style="position:absolute; top: 0; opacity: 0;/*breaks up phone number type pattern for ipad*/">:</i>00</label></div></div>
                <div class="column" for="0900"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">0900</label></div></div>
                <div class="column" for="1000"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">1000</label></div></div>
                <div class="column" for="1100"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">1100</label></div></div>
                <div class="column" for="1200"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">1200</label></div></div>
                <div class="column" for="1300"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">1300</label></div></div>
                <div class="column" for="1400"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">1400</label></div></div>
                <div class="column" for="1500"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">1500</label></div></div>
                <div class="column" for="1600"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">16<i style="position:absolute; top: 0; opacity: 0;">:</i>00</label></div></div>
                <div class="column" for="1700"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">1700</label></div></div>
                <div class="column" for="1800"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">1800</label></div></div>
                <div class="column" for="1900"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">1900</label></div></div>
                <div class="column" for="2000"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">20<i style="position:absolute; top: 0; opacity: 0;">:</i>00</label></div></div>
                <div class="column" for="2100"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">2100</label></div></div>
                <div class="column" for="2200"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">2200</label></div></div>
                <div class="column" for="2300"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">2300</label></div></div>
                <div class="column" for="2400"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">24<i style="position:absolute; top: 0; opacity: 0;">:</i>00</label></div></div>
              </div>
          </div>
          </div>
          <script>

            window.donut = function (element, options) {
              options = options || {};
              for (var key in donut.defaults) {
                options[key] = options[key] === undefined ? donut.defaults[key] : options[key];
              }
              var canvas = element || document.getElementById("canvas1");
              canvas.height = canvas.offsetHeight;
              canvas.width = canvas.offsetWidth;
              var ctx = canvas.getContext("2d");
              var circleLineWidth = 90;


              /* normally we round everything for canvas perf
               but that screws up our circle render... so
               */
              var mapDataToCircle = function (data) {
                return (data / 100 * Math.PI * 2);
              };

              return { draw: function (percent, deg) {
                var canvas = element;
                canvas.height += 1;
                canvas.height -= 1;
                var startAngle = deg || 270;
                // map start angle to radians
                var arcStart = Math.PI * startAngle / 180;
                var arcEnd = arcStart + mapDataToCircle(percent);
                ctx.save();
                ctx.strokeStyle = options.color;
                ctx.lineWidth = circleLineWidth / 2;
                ctx.beginPath();
                var center = { x: canvas.width / 2, y: canvas.height / 2 };
                ctx.arc(center.x, center.y, options.radius, arcStart, arcEnd, false);
                ctx.stroke();
                ctx.restore();
              } };
            };
          </script>
        </div>
        <script>
          (function() {
            window.offersets = {
              prep: function(data) {
                var ro = data['redeemed_offerset'];
                if(ro && !('a_redeemed' in data)) {
                  var so = data['selected_offerset'];
                  var abcd = ['a', 'b', 'c', 'd'];
                  ro.forEach(function(item, i) {
                    var label = abcd.shift();
                    data[label + '_redeemed'] = item;
                    data[label + '_selected'] = so[i];
                    data[label + '_percent'] = Math.round(100 * item / so[i]) || 0;
                  });
                }
              },
              update: function(data, element) {
                if('a_redeemed' in data) {
                  var bars = element.querySelectorAll('div.option div.progress div.full');
                  ['a', 'b', 'c', 'd'].forEach(function(item, i) {
                    var p = data[item + '_percent'];
                    bars[i].style.width = (p > 100 ? 100 : p) + '%';
                  });
                }
              }
            };
          })();
          (function () {
            donut.defaults = { color: 'rgb(0, 153, 0)', radius: 100 };
            var nut = donut(document.querySelector('div.exec div.donut canvas'));
            window.d = {
              draw: function (value, deg, text) {
//                return;
                nut.draw(value, deg);
                Array.forEach(document.querySelectorAll('div.exec *[bind="redeemed percent"]'), function(element) {
                  element.firstChild.nodeValue = text === undefined ? value : text;
                });
              }
            };
//            d.draw(78);
          })();
        (function() {
          var count;
          var timer;
          window.spin = function() {
            var start = new Date();
            count = 0;
            clearInterval(timer);
            timer = setInterval(function() {
              var percent = count % 360;
              count += 2;
              if (count > 1400) {
                  window.spin.stop();
                  console.log('no db?' + (new Date() - start) / 1000);
              }
              d.draw(1, percent - 90, Math.round(percent/360 * 100));
            }, 50);

          };
          window.spin.stop = function() {
            count = 0;
            clearInterval(timer);
          };
          window.fetchData = function(path, spin, done) {
//            var base = 'http://10.75.3.66:8080/xi/dashboard/execsummary/';
//            var base = 'http://twinkle.local:8080/xi/dashboard/execsummary/';
//            var base = 'http://sparklepony.local:8080/xi/dashboard/execsummary/';
//            var base = 'http://10.92.63.92:8080/xi/dashboard/';//a
//            var base = 'http://10.110.1.104:8090/xi/dashboard/';
//            var base = 'http://10.93.1.197:8080/xi/dashboard/';//l
//            var base = 'http://10.75.2.84:8080/xi/dashboard/';
//            var base = 'http://10.1.200.84:8080/xi/dashboard/';
//            var base = 'http://10.93.1.216:8080/xi/dashboard/';
//            var base = 'http://10.1.50.179:8080/xi/dashboard/';
//            var base = 'http://10.75.3.18:8080/xi/dashboard/';
            var base = '/xi/dashboard/';
            var s = document.createElement('script');
            var buster = [new Date() * 1, fetchData.unique++].join('_');
            if (done) {
              window.busters = window.busters || {};
              busters[buster] = done;
            }
            s.src = base + path + '?buster=' + buster;
//                s.src = '/dashboard/execsummary.js?foo' + (new Date() * 1);
            s.setAttribute('time', new Date() * 1);
            document.body.appendChild(s);
            setTimeout(function() {
              var remove = s.parentNode && s.parentNode.removeChild(s);
            }, 90000);
            var progress = spin !== false && window.spin();
          };
          window.fetchData.unique = 1;
          window.reasons = {
            load: function (data) {
              var map = {
                'No Xpass' : 1,
                'Early' : 2,
                'n/a': 3,
                'Late' : 4,
                'Already Redeemed': 5,
                'Wrong Experience' : 6
              };
              var binds = document.body.querySelectorAll('.reasons *[bind]');
              Array.forEach(binds, function(element) {
                var prop = map[element.getAttribute('bind')];
                if (prop) {
                  element.firstChild.nodeValue = data[prop] || 0;
                }
              });
            }
          };
          var progressList = function (type) {
            var list = {
              entitlements: {
                part: 'redeemedEntitlements',
                whole: 'selectedEntitlements'
              },
              blue: {
                part: 'blOverrideCount',
                whole: 'blEventCount'
              }
            };
            return {
              fetch: function(path, spin) {
                fetchData(type + '/' + path, spin);
              },
              remote: function(body) {
                if (body.status === 'success') {
                  var data = body.data.data;
                  var d = body.data.date;
                  if (d === calendar.date.toString(calendar.yesterday)) {
                    d = 'yesterday';
                  }
                  if (body.data.reasonCodes) {
                    data.reasons = body.data.reasonCodes;
                  }
                  calendar.data[type][d] = data;
                  var s = tab.selected();
                  window[type].load(s);
                }
              },
              load: function(element) {
                var data;
                var bind = function (data) {
                  if (data) {
                    var max = Math.max.apply(Math, data.map(function(item) {
                      return item[list[type].whole];
                    }));
                    var updateRow = function(row, item) {
                      var data = {
                        iter_part: item[list[type].part],
                        iter_whole: item[list[type].whole],
                        iter_percent: Math.round(100 * item[list[type].part] / item[list[type].whole]) || 0
                      };
                      var progress = row.querySelector('div.progress');
                      progress.style.width = (Math.round(100 * item[list[type].whole]/max) || 0) + '%';
                      progress.firstChild.style.width = (data.iter_percent > 100 ? 100 : data.iter_percent) + '%';
                      Array.forEach(row.querySelectorAll('*[bind]'), function(element) {
                        var fs = element.firstChild;
                        var prop = element.getAttribute('bind');
                        fs.nodeValue = prop in data ? data[prop] : fs.nodeValue;
                      });
                    };
                    if (data.reasons) {
                      reasons.load(data.reasons);
                    }
                    data.forEach(function(item) {
//                  var facility = item.attraction.replace('\u0027', "'");
                      var facility = item.attractionId;
                      var row = document.getElementById(type).querySelector('div.rows > div[for="' + facility + '"]');
                      var update = row && updateRow(row, item);
                    });
                  }
                };
                if (type === 'blue') {
//                  console.log('blue');
                }
                var h = calendar.data[type];
                var basic = function (prop, element) {
                  if (data = h[prop]) {
                    bind(data);
                  } else {
                    if (prop === 'yesterday') {
                      prop = calendar.date.toString(calendar.yesterday);
                    }
                    window[type].fetch(prop);
                  }
                };
                var map = {
                  day: function (prop, element) {
                    //do nothing;
                  },
                  custom: function (prop, element) {
                    prop = calendar.date.toString(new Date(element.getAttribute('day')));
                    if (data = h[prop]) {
                      bind(data);
                    } else {
                      window[type].fetch(prop);
                    }
                  }
                };
                map.today = map.yesterday = map.todate = basic;
                var prop = element.getAttribute('for');
                var set = prop && map[prop] && map[prop](prop, element);
                //exec.load(element);
              }
            };
          };
          window.exec = {
            fetch: function(path, spin) {
              fetchData('execsummary/' + path, spin);
            },
            force: function(guestsInQueue) {
              var exec = document.body.querySelector('div.exec');
              if (document.body.querySelector('nav #exec_nav.selected')) {
                var canvas = exec.querySelector('canvas');
                var e2 = exec.cloneNode(true);
                var c2 = e2.querySelector('canvas');
                c2.parentNode.replaceChild(canvas, c2);
                exec.parentNode.replaceChild(e2, exec);
              }
              setTimeout(function() {
                var data = calendar.data.exec && calendar.data.exec.today && calendar.data.exec.today.extended;
//                var f = data && flip(data['guests in queue']);
                var f = window.grandTotal && flip(grandTotal);
              }, 200);
            },
            load: function(element) {
              var data;
              //todo: have hourly loaded here and show up on all days;
              var bind = function(data) {
                if (data) {
//                  data = data.today || data;
                  data['redeemed percent'] = (data.selected && Math.round(100 * data.redeemed / data.selected)) || 0;
                  //todo: check binding with zeros
                  //todo: update progress bars, add percentages to them.
                  offersets.prep(data);
                  offersets.update(data, document.body.querySelector('div.offersets'));
                  var binds = document.body.querySelectorAll('div.exec *[bind]');
                  Array.forEach(binds, function (element) {
                    var prop = element.getAttribute('bind');
                    var set = prop in data && (element.firstChild.nodeValue = data[prop]);
                  });
                  d.draw(data['redeemed percent']);
                  (function () {
                    var t = tab.selected();
                    donut(t.querySelector('canvas'), { radius: 44 }).draw(data['redeemed percent']);
                  })();
                }
              };
              var h = calendar.data.exec;
              var basic = function(prop, element) {
                if (data = h[prop] && h[prop].extended) {
                  bind(data);
                } else {
                  exec.fetch(prop);
                }
              };
              var map = {
                day: function(prop , element) {
                  //do nothing;
                },
                custom: function(prop , element) {
                  prop = calendar.date.toString(new Date(element.getAttribute('day')));
                  if (data = h[prop] && h[prop].extended) {
                    bind(data);
                  } else {
                    exec.fetch(prop);
                  }
                }
              };
              map.today = map.yesterday = map.todate = basic;
              var prop = element.getAttribute('for');
              var set = prop && map[prop] && map[prop](prop, element);
              (function() {
                var total = document.body.querySelector('div.exec div.total_participants');
                var t2 = total.cloneNode(true);
                total.parentNode.replaceChild(t2, total);
                setTimeout(function() {
                  t2.style.webkitTransform = 'scale(0.99)';
                  setTimeout(function() {
//                    exec.style.webkitTransform = 'rotate(0)';
                    t2.style.webkitTransform = 'scale(1)';
                  }, 120);
                }, 120);
              })();
              exec.force();
            }
          };
          window.entitlements = progressList('entitlements');
          /*window.entitlements.fetch = function(path, spin) {
            //todo: add stuff for donut updating
            fetchData('execsummary/' + path, spin);
          };*/
          window.blue = progressList('blue');
          window.blue.fetch = function(path, spin) {
            fetchData('bluelane/' + path, spin);
          };
          (function () {
            var current;
            window.facility = {
              fetch: function (path, spin) {
                fetchData('entitlements/facility/' + path, spin);
              },
              remote: function (body) {
                if (body.status === 'success') {
                  var data = body.data.data;
                  var id = data && data[0] && data[0].attractionId;
                  var d = body.data.date;
                  if (d === calendar.date.toString(calendar.yesterday)) {
                    d = 'yesterday';
                  }
                  var facilities = calendar.data.entitlements[d].facilities = calendar.data.entitlements[d].facilities || {};
                  facilities[id] = data;
                  var s = tab.selected();
                  var row = document.body.querySelector('#entitlements div.rows > div.row[for="' + id + '"]');
                  if (row) {
                    facility.load(s, id, row);
                  }
                }
              },
              load: function (element, id, row) {
                var data;
                var bind = function (data) {
                  if (data) {
                    var max = Math.max.apply(Math, data.map(function (item) {
                      return item.selectedEntitlements;
                    }));
//              var detailTable;
                    window.detailTable = null;
                    (function () {
                      var first = data[0];
                      if (first) {
                        var index = 0;
                        var props = [];
//                  var headers = body.data.dataHeader;
                        var headers = ["Facility", "Facility ID", "Hour", "Guests In Queue", "Redeemed", "Selected", "Available", "Blue lanes", "Overrides"];
                        props = ["attraction", "attractionId", "time", "guestsInQueue", "redeemedEntitlements", "selectedEntitlements", "availableEntitlements", "totalBlueLane", "overridesBlueLane"]
                      }
                      window.detailTable = function () {
                        var t = table(headers, props, data);
                        var tbody = t.tBodies[0];
                        data.forEach(function (row, i) {
                          var b = document.createElement('b');
                          b.appendChild(document.createTextNode(' (' + (Math.round(row.redeemedEntitlements / row.selectedEntitlements * 100) || 0) + '%)'));
                          tbody.rows[i].cells[4].appendChild(b);
                          tbody.rows[i].cells[6].firstChild.nodeValue = 'n/a';
                        });
                        return t;
                      };
                    })();
                    var showGuest = function (e) {
                      e.stopPropagation();
                    };
                    window.scrollToTop = function (row) {
                      row.scrollTop = 0;
                      row.scrollLeft = 0;
                      var detail = row.querySelector('div.detail');
                      if (detail) {
                        detail.scrollTop = 0;
                        detail.scrollLeft = 0;
                      }
                    };
                    var click = function (e) {
                      var detail = row.querySelector('div.detail');
                      var current = detail.querySelector('div.column.selected');
                      if (!/^T/.test(this.tagName)) { //no action for tables
                        var remove = current && current.classList.remove('selected');
                        if (current === this) {
                          detail.classList.remove('compact');
                        } else {
                          this.classList.add('selected');
                          guests.load(tab.selected(), row.getAttribute('for'), this);
                          detail.classList.add('compact');
                        }
                      }
                    };
                    data.forEach(function (item) {
                      item.time = item.hour < 10 ? '0' + item.hour : item.hour;
                      item.time += '00';
                      var column = row.querySelector('div.column[for="' + item.time + '"]');
                      if (column) {
                        var progress = column.querySelector('div.progress');
                        progress.style.height = (Math.round(100 * item.selectedEntitlements / max) || 0) + '%';
                        var percent = Math.round(100 * item.redeemedEntitlements / item.selectedEntitlements) || 0;
                        progress.querySelector('div.full').style.height = (percent > 100 ? 100 : percent) + '%';
                        progress.querySelector('*[bind="inner_percent"]').firstChild.nodeValue = percent;
                        if (item.selectedEntitlements === max) {
//                    row.querySelector('hr.tick').style.bottom = percent + '%';
                        }
                        if (!column.getAttribute('ready')) {
                          column.addEventListener('click', click, false);
                        }
                        column.setAttribute('ready', 1);

                      }
//                console.log(item.hour, column);
                    });


                  }
                };
                var d = element.getAttribute('for');
                if (d === 'custom') {
                  d = calendar.date.toString(new Date(element.getAttribute('day')));
                }
                var h = calendar.data.entitlements[d];
                var facilities = h.facilities;
                if (facilities && facilities[id]) {
                  bind(facilities[id])
                } else {
                  facility.fetch([id, d].join('/'));
                }
              },
              make: function (facility, type) {
                type = type || 'entitlements';
                var entitlements = entitlements || document.getElementById(type);
                var c = document.querySelector('div.template_area #' + type + '_facility_base');
                c = c && c.cloneNode(true);
                if (c) {
                  try {
                    c.removeAttribute('id');
                  } catch (ex) {}
                  var name = c.querySelector('h3');
                  name = name && name.firstChild && (name.firstChild.nodeValue = facility.name);
                  c.id = facility.facilityId;
                  c.setAttribute('for', facility.facilityId);
                }
                if (type !== 'entitlements') {
                  return c;
                }
                var timer = -1;
                var row = c;
                row.addEventListener('touchmove', function (e) {
                  clearTimeout(timer);
                  timer = -1;
                }, false);
                var clone = row.cloneNode(true);
                row.addEventListener('scroll', function (e) {
                  if (!row.classList.contains('open')) {
                    row.scrollTop = 0;
                  }
                }, false);
                row.addEventListener('dblclick', function (e) {
                  row.classList.toggle('table');
                }, false);
                (function () {
                  var click = function (e) {
                    clearTimeout(timer);
                    if (timer < 0) {
                      timer = setTimeout(function () {
                        timer = -1;
                        if (current && current !== row) {
                          scrollToTop(current);
                          current.classList.remove('open');
                        }
                        var tn = document.createTextNode('\u00a0');
                        entitlements.style.webkitTransform = 'scale(1)';
                        setTimeout(function () {
                          if (!row.querySelector('table[for="detail"]')) {
                            var detail = row.querySelector('div.detail');
                            var dt = detailTable();
                            detail.appendChild(dt);
                            dt.setAttribute('for', 'detail');
                            var toggle = document.createElement('a');
                            toggle.classList.add('white');
                            toggle.classList.add('button');
                            toggle.appendChild(document.createTextNode('List'));
                            detail.appendChild(toggle);
                            toggle.addEventListener(touch, function (e) {
                              row.classList.toggle('table');
                              toggle.firstChild.nodeValue = row.classList.contains('table') ? 'Chart' : 'List';
                            }, false);
                          }
                          entitlements.style.webkitTransform = 'rotate(0)';
                        }, 3000);
                        row.classList.toggle('open');
                        if (row.classList.contains('open')) {
                          window.facility.load(tab.selected(), row.getAttribute('for'), row);
                          current = row;
                        } else {
                          current = null;
                        }
                      }, 30);
                    }
                  };
                  (queryDirectChildrenBySelector(row, 'div.top') || []).forEach(function (element) {
                    element.addEventListener('click', click, false);
                  });
                })();
                return c;
              }
            };
          })();
          window.config = {
            facilities: {
              fetch: function(path, spin, done) {
                fetchData('config/facilities' + path, spin, done);
              },
              render: function(body) {
                var facilities = body && body.data && body.data.facilities;
                window.idToNick = function(id) {
                  return (facilities[id] && facilities[id].shortName) || id;
                };
                var et = document.querySelector('#entitlements_target');
                var bt = document.querySelector('#blue_target');
                var queues = [];
                var fac;
                for (var key in facilities) {
                  fac = facilities[key] || {};
                  if (!/^fake/i.test(fac.name)) {
                    et.appendChild(facility.make(fac));
                    bt.appendChild(facility.make(fac, 'blue'));
                    queues.push(fac);
                  }
                }
                setTimeout(function() {
                  counters.init(queues);
                });
              }
            }
          };
          (function () {
            var headers = ['Time', 'Email', 'Id'];
            var props = ['time', 'email', 'guestId'];
            var showGuest = function(e) {
              guest.load(tab.selected(), this.getAttribute('for'));
              e.stopPropagation();
            };
            window.guests = {
              fetch: function (path, spin, done) {
                var base = (path === 'now') ? 'guests/search/' : 'guests/facility/';
                fetchData(base + path, spin, done);
              },
              remote: function (body) {
                if (body.status === 'success') {
                  var data = body.data;
                  var d = body.data.date;
                  if (d === calendar.date.toString(calendar.yesterday)) {
                    d = 'yesterday';
                  }
                  var facilities = calendar.data.entitlements[d].facilities = calendar.data.entitlements[d].facilities || {};
                  if (body.data.data.merge) {
                    data = (body.data.data.merge || []).concat(body.data.data.fp_entry || []).concat(body.data.data.exit || []);
                  }
                  var f = facilities[body.data.facility].hourly = data;
                  //todo: once filtering is server side put data in a more specific spot
                  var s = tab.selected();
                  var row = document.body.querySelector('#entitlements div.rows > div.row[for="' + body.data.facility + '"]');
                  var column = row && row.querySelector('div.chart.vertical div.column.selected');
                  var hour = column && column.getAttribute('for');
                  if (body.data.facility && column) {
                    guests.load(s, body.data.facility, column);
                  }
                }
              },
              load: function (element, id, column) {
                var bind = function (data) {
                  var t = column.querySelector('table');
                  if (!t) {
//                    console.log(id, idToNick(id), 'no table');
                    console.log(idToNick(id), data);
                    t = table(headers, props, data, function(row, item) {
                      row.setAttribute('for', item.guestId);
                    });
                    t.setAttribute('temporal', tab.date());
                    column.appendChild(t);
                    var alt;
                    t.addEventListener(touch, function(e) {
                      e.stopPropagation(e);
                      t.style.webkitTransform = alt ? 'rotate(0)' : 'scale(1)';
                      alt = !alt;
                    }, true);
                    Array.forEach(t.tBodies[0].rows, function(row) {
                      row.addEventListener(touchEnd, showGuest, false);
                    });
                  }
                  return t;
                };
                var d = element.getAttribute('for');
                if (d === 'custom') {
                  d = calendar.date.toString(new Date(element.getAttribute('day')));
                }
                if (d === 'search') {
                  column = element;
                  var data = id;
                  data.forEach(function(item) {
                    item.time = calendar.date.readTime(item.lastRead);
                  });
                  bind(data);
                } else {
                  var h = calendar.data.entitlements[d];
                  var facilities = h.facilities;
                  var fac = facilities && facilities[id];
                  var hour = column && column.getAttribute('for');
                  var filter = function (data, hour) {
                    return data.filter(function (item) {
                      var time = calendar.date.readTime(item.lastRead);
//                      console.log(time);
                      /*var pm = /pm/i.test(time);
                      var h = (/(\d?\d)\:/.exec(time) || [])[1] || 0;
                      h = h * 1;
                      var twelve = h === 12;
                      if (twelve && !pm) {
                        h = 0;
                      }
                      if (pm && !twelve) {
                        h += 12;
                      }*/
//                      console.log((/^\d\d/.exec(time) || [])[0] || 98, /^\d\d/.exec(hour));
                      return (/^\d\d/.exec(time) || [])[0] == /^\d\d/.exec(hour);
                    });
                  };
                  if (fac && fac.hourly /*&& fac.hourly[hour]*/) {//todo: put back once server side filtering is implemented
                    fac.hourly.forEach(function (item) {
                      item.time = calendar.date.readTime(item.lastRead);
                    });
                    bind(filter(fac.hourly, hour));
                  } else {
//                guests.fetch([id, d, hour].join('/'));//todo: use once implemented
                    guests.fetch([id, d].join('/'), false);
                  }
                }
              }
            };
          })();
          window.guest = {
            fetch: function(path, spin) {
              fetchData('guests/guest/' + path, spin);
            },
            remote: function(body) {
              if (body.status === 'success') {
                var d = body.data.date;
                if (d === calendar.date.toString(calendar.yesterday)) {
                  d = 'yesterday';
                }
                var g = calendar.data.guests[d] = calendar.data.guests[d] || {};
                var data = body.data.data;
                if (data.guestId) {
                  g[data.guestId] = data;
                  guest.load(tab.selected(), data.guestId);
                }
              }
            },
            load: function(element, id) {
              var bind = function(data) {
                var binds = document.body.querySelectorAll('#guest *[bind]');
                Array.forEach(binds, function (element) {
                  var prop = element.getAttribute('bind');
                  var set = prop in data && (element.firstChild.nodeValue = data[prop]);
                });
                var visitor = function(item) {
                  var t = item.timestamp && (item.time = ((/\d\d\d\d\-\d\d?\-\d\d?\s(\d\d?\:\d\d\:\d+)\.?/.exec(item.timestamp) || [])[1]) || '');
                  item.attraction = item.attraction || ''; //for kiosk
                };
                data.entitlementList.forEach(visitor);
                data.guestReadList.forEach(visitor);
                data.experienceList.forEach(visitor);
                var tBodies = document.querySelectorAll('#guest table tbody');
                Array.forEach(tBodies, function(tb, i) {
                  var tr;
                  while (tr = tb.childNodes[tb.childNodes.length - 1]) {
                    tb.removeChild(tr);
                  }
                });
                table([1,2,3], ['attraction', 'windowStart','windowStatus'], data.entitlementList, function(row, item) {
                  row.cells[1].firstChild.nodeValue += '-' + item.windowEnd;
                  tBodies[0].appendChild(row);
                });
                table([1,2,3], ['time', 'attraction', 'readerLocation'], data.guestReadList, function(row) {
                  tBodies[1].appendChild(row);
                });
                table([1,2,3], ['time', 'attraction', 'waitTime'], data.experienceList, function(row) {
                  row.cells[2].firstChild.nodeValue += ' minutes';
                  tBodies[2].appendChild(row);
                });

                document.getElementById('guest').classList.add('shown');
              };
              var d = element.getAttribute('for');
              if (d === 'custom') {
                d = calendar.date.toString(new Date(element.getAttribute('day')));
              }
              var gs = calendar.data.guests[d];
              if (gs && gs[id]) {
                bind(gs[id]);
              } else {
                guest.fetch([id, d].join('/'));
              }
            }
          };
          window.currentView = exec;
            window.remoteData = function (body, target, options) {
              //todo: verify that request is still revelant. check tab and such
              window.spin.stop();
              var data = body && body.data;
              if (body && body.status === 'success') {
                if (body.buster && window.busters && busters[body.buster]) {
                  busters[body.buster](body);
                  try {
                    delete busters[data.buster];
                  } catch (ex) {}
                }
                if (data && data.calendar) {
//                  var date = new Date(calendar.today); //todo handle paging, going further back in time
                  var date = new Date(calendar.future);
                  calendar.data = calendar.data || [];
                  calendar.data.exec = calendar.data.exec || {};
                  var add = body.status === 'success' && data.calendar.forEach(function(item) {
                    calendar.data.push(item);
                    calendar.data.exec[calendar.date.toString(date)] = item;
                    date.setDate(date.getDate() - 1);
                  });
                  calendar[calendar.load ? 'load' : 'stage'](calendar.month);
                  return;
                } else if (data && data.dataHeader && data.dataHeader.join('|') === ["Facility","Guests In Queue","Available Entitlement","Selected Entitlement","Redeemed Entitlements","Total Blue Occurrences"].join('|')) {
                  entitlements.remote(body);
                  return;
                } else if (data && data.dataHeader && data.dataHeader.join('|') === ["attraction","events","overrides"].join('|')) {
                  blue.remote(body);
                  return;
                } else if (data && data.dataHeader && data.dataHeader.join('|') === ["Hour","Facility","Guests In Queue","Available Entitlement","Selected Entitlement","Redeemed Entitlements","Total Blue Occurrences"].join('|')) {
                  facility.remote(body);
                  return;
                } else if (data && data.dataHeader && data.dataHeader.join('|') === ["Guest Id","First Name","Last Name","Email","Time"].join('|')) {
                  guests.remote(body);
                  return;
                } else if (data && data.data && data.data.guestId) {
                  guest.remote(body);
                  return;
                } else if (data && data.date === 'now') {
                  data = data.today;
                  offersets.prep(data);
                  var t = calendar.data.exec.today = [data.redeemed, data.selected];
                  data['redeemed percent'] = (data.selected && Math.round(100 * data.redeemed / data.selected)) || 0;
                  t.extended = data;
//                var t = donut.make(document.body.querySelector('div[for="today"] > div'), data, { radius: 44/*, color: '#fff'*/ });
                  var t = document.body.querySelector('div[for="today"] > div div.donut');
                  var u = t && donut(t.querySelector('canvas'), { radius: 44 }).draw(data['redeemed percent']);
                  (function (){
                    var p = data.projected;
                    var projectedPercent = ((p.redeemed/p.selected) * p.totalDaySelected)/p.totalDaySelected;
                    donut.setProjected(document.querySelector('div.entitlements div.donut'), projectedPercent);
                  })();
                  if (body.data.subway) {
                    counters.update(body.data.subway);
                    window.subway = body.data.subway;
                    (function () {
                      for (var k in subway) {
                        var c = subway[k];
                        var nick = idToNick(k);
                        subway[nick] = c;
                        c.fp_entry = c.entry;
                        try {
                          delete c.entry;
                        } catch (ex) {}
                        window.counts.update(nick, c);
                      }
                    })();
                  }
                  u = t && t.setAttribute('percent', data['redeemed percent']);
                  if (!document.body.querySelector('div[for="today"].on')) {
                    return;
                  }
                  offersets.prep(data);
                  offersets.update(data, document.body.querySelector('div.offersets'));
                } else if (data && data.yesterday) {
                  data = data.today;
                  offersets.prep(data);
                  offersets.update(data, document.body.querySelector('div.offersets'));
                  var t = calendar.data.exec.today = [data.redeemed, data.selected];
                  t.extended = data;
                  var yesterday = body.data.yesterday;
                  offersets.prep(data);
                  try { delete yesterday['guests in queue'] } catch (ex) {}//todo: add to other days
                  var y = calendar.data.exec.yesterday = [yesterday.redeemed, yesterday.selected];
                  y.extended = yesterday;
                  (function() {
//          var options = { radius: 37, color: '#555' };
                    var data = calendar.data.exec.yesterday.extended;
                    var y = donut.make(document.body.querySelector('div[for="yesterday"] > div'), data, { radius: 46 });
                    y.setAttribute('percent', data['redeemed percent']);
                    data = calendar.data.exec.today.extended;
                    var t = donut.make(document.body.querySelector('div[for="today"] > div'), data, { radius: 44/*, color: '#fff'*/ });
                    t.setAttribute('percent', data['redeemed percent']);
                  })();
                  setTimeout(window.now, 100);
                } else if (data && data.today) {
                  calendar.data.exec[body.data.date] = calendar.data.exec[body.data.date] || [0, 0];
                  data = calendar.data.exec[body.data.date].extended = data.today;
                }
              } else {
                console.log('------------', body.status, JSON.stringify(body));
              }
              target = target || document.body.querySelector('div.exec'); //todo: perf;
              if (body.status === 'success') {
                data.selected = data.selected || 0;
                data.redeemed = data.redeemed || 0;
                data['redeemed percent'] = (data.selected && Math.round(100 * data.redeemed / data.selected)) || 0;
                var canvas = target.querySelector('canvas');
                if (canvas) {
                  donut(canvas, options).draw(data['redeemed percent']);
                }
              } else {
                data = {
                  participants: 'n/a',
                  redeemed: 'n/a',
                  selected: 'n/a',
                  'redeemed percent': '',
                  'guests in queue': 'n/a'
                }
              }
              if ('redeemed percent' in data) {
                offersets.prep(data);
                setTimeout(function (){
                  var t = tab.selected();
                  if (t && t.getAttribute('for') === 'custom') {
                    donut(t.querySelector('canvas'), { radius: 44 }).draw(data['redeemed percent']);
                  }
                }, 300);
              }
              //todo: use exec.load?
              if ('total bluelanes' in data) {
                data.total_traffic = data.redeemed + data['total bluelanes'] + data['total overrides'];
              }
              if (body.data.redemptions) {
//                console.log(body.data.redemptions);
                hourly.load(body.data.redemptions);
              }
              Array.forEach(target.querySelectorAll('*[bind]'), function (element) {
                var value = data[element.getAttribute('bind')];
                if (value !== undefined) {
                  element.firstChild.nodeValue = value;
                }
              });
              exec.force(data['guest in queue']);
            };
          })();
         (function() {
           //helper for donut.make
           var add = function (type, classes, text, target) {
             var r = document.createElement(type);
             var list = classes.pop ? classes : /\s/.test(classes) ? classes.split(' ') : [classes];
             list.forEach(function (item) {
               r.classList.add(item);
             });
             var tn = text && r.appendChild(document.createTextNode(text));
             var append = target && target.appendChild(r);
             return r;
           };
           add.span = 'span';
           add.canvas = 'canvas';
           add.div = 'div';
           add.label = 'label';
           add.nbsp = '\u00a0';
           donut.make = function (target, data, options) {
             var div = document.createElement('div');
             div.classList.add('donut');
             var bg = add(add.div, 'bg', null, div);
             add(add.canvas, [], null, bg);
             add(add.div, 'border', add.nbsp, div);
             add(add.div, 'inner_shadow', add.nbsp, div);
             var hole = add(add.div, 'hole', null, div);
             var values = add(add.div, 'values', null, hole);
             var redeemedPercent = add(add.div, [], add.nbsp, values);
             redeemedPercent.setAttribute('bind', 'redeemed percent');
             add(add.span, [], '%', redeemedPercent);
             add(add.label, [], 'Redeemed', redeemedPercent);
             (function () {
               var values = add(add.div, 'values', null, div);
//                values.style.marginRight = '-13px';
               var redeemed = add(add.span, [], add.nbsp, values);
               redeemed.setAttribute('bind', 'redeemed');
               values.appendChild(document.createTextNode(' redeemed / '));
               var selected = add(add.span, [], add.nbsp, values);
               selected.setAttribute('bind', 'selected');
               values.appendChild(document.createTextNode(' selected '));
             })();
             target.appendChild(div);
             if (data) {
               data['redeemed percent'] = (data.selected && Math.round(100 * data.redeemed / data.selected)) || 0;
             }
             var bind = data && remoteData({ status: 'success', data: data }, div, options);
             return div;
           };
           (function() {
             var rotate = function(element, percent) {
               var deg = Math.round((percent || 0) * 360) + 'deg';
               element.style['-webkit-transform'] = 'rotate(' + deg + ')';
               var start = element.querySelector('div.start');
               var s = start && start.setAttribute('percent', Math.round(percent * 100) % 100);
               s = start && (start.style['-webkit-transform'] = 'rotate(-' + deg + ')');
             };
             donut.addProjected = function(donut, percent) {
               if (!donut.querySelector('div.projected')) {
                 var div = function(classNames, space) {
                   var r = document.createElement('div');
                   var c = classNames && (r.className = classNames);
                   var s = space && r.appendChild(document.createTextNode('\u00a0')); //nbsp;
                   return r;
                 };
                 var add= function(element, parent) {
                   parent.appendChild(element);
                   return element;
                 };
                 var wrap = div('projected');
                 wrap.setAttribute('optional', 'projected');
                 var line = add(div('line'), wrap);
                 add(div('start', true), line);
                 add(div('connection', true), line);
                 add(div('end', true), line);
                 rotate(line, percent);
                 add(wrap, donut);
               }
             };
             donut.setProjected = function(donut, percent) {
               rotate(donut.querySelector('div.projected div.line'), percent);
             };
             donut.addProjected(document.querySelector('div.entitlements div.donut'), 0.85);
           })();
         })();

        </script>
        <div class="guest col">
          <h2>Guests</h2>
          <div class="sunken"><div class="total_participants" num="5" bind="participants">&nbsp;<label>Test Participants</label></div></div>
          <div class="in_queue" onclick="document.querySelector('#queue_counters').classList.add('shown')" style="cursor: pointer;">
            <hr />
            <div for="all" class="flipper"><div class="top"></div><div class="top"></div><div class="bottom"></div><label class="insetText" bind="" num="6">&nbsp;</label><label class="insetText">&nbsp;</label><div class="crease"><span class="hinge">hinge</span><span class="hinge">hinge</span></div><hr /></div>
            <div class="values">Currently in  <span style="text-decoration: underline;">FP queue</span></div>
          </div>
        </div>
        <script>
          (function() {
            window.flip = function(value, selector) {
              var flipper = document.querySelector(selector || 'div.flipper[for="all"]');
              var change = value !== undefined && value != flipper.querySelector('label').firstChild.nodeValue;
              if (change) {
                flipper.classList.add('flip');
                setTimeout(function() {
                  flipper.querySelector('label').firstChild.nodeValue = value;
                }, 250);
              }
              setTimeout(function() {
                flipper.classList.remove('flip');
              }, 500);
            };
          })();
          (function() {
            var picker = document.querySelector('div.time_picker');
            var tabs = document.body.querySelectorAll('div.time_picker > div');
            window.initialPickerLength = tabs.length;
            var timer;
            var click = function() {
              clearTimeout(timer);
              var current = document.body.querySelector('div.time_picker > div.on');
              var tab = this;
              window.wrap = document.body.querySelector('div.wrap');
              var close = Array.forEach(wrap.querySelectorAll('div.open'), function(element) {
                scrollToTop(element);
                //todo: keep these open and update the data.
                element.classList.remove('open')
              });
              var show = this.getAttribute('show') || 'hide_guests';
              var guest = wrap.querySelector('div.guest.col');
              var map = {
                hide_guests: function() {
                  wrap.classList.remove('dozen');
                  wrap.classList.remove('guests');
                },
                dozen: function() {
                  wrap.classList.remove('guests');
                  wrap.classList.remove('hide_guests');
                },
                guests: function() {
                  wrap.classList.remove('dozen');
                  wrap.classList.remove('hide_guests');
                }
              };
              var remove = map[show] && map[show]();
              setTimeout(function() {
                wrap.classList.add(show);
                wrap.setAttribute('show', show);
              }, 0);
              if (this !== current) {
//                  document.body.querySelector('div.wrap').setAttribute('show', this.getAttribute('show') || 'hide_guests');
                current.classList.remove('on');
                this.classList.add('on');
                Array.forEach(wrap.querySelectorAll('div.detail.table'), function(div) {
                  div.classList.remove('table');
                });
                Array.forEach(wrap.querySelectorAll('div.detail a.button.white'), function(element) {
                  var pn = element.parentNode;
                  var remove = pn && pn.removeChild(element);
                });
                var yank = Array.forEach(wrap.querySelectorAll('table:not([temporal="' + window.tab.date() + '"])'), function(element) {
                  if (!element.classList.contains('reasons')) {
                    var p = element.parentNode;
                    var remove = p && p.removeChild(element);
                    var close = p && p.classList.remove('selected');
                    //todo: handle moving to calendar and back better
                  }
                });
                var element = this;
                timer = setTimeout(function() {
                  currentView.load(element);
//                  exec.load(element);
                }, 200);
              }
            };
            window.tab = {
              click: function (tab, e) {
                click.apply(tab, [e]);
              },
              init: function(tab) {
                tab.addEventListener(touch, click, false);
                return click;
              },
              selected: function() {
                return document.body.querySelector('div.time_picker > div.on');
              },
              date: function(element) {
                var t = element || document.body.querySelector('div.time_picker > div.on:not([for="day"])');
                var d = calendar.today;
                if (t) {
                  var f = t.getAttribute('for');
                  d = calendar[f] || new Date(t.getAttribute('day'));
                }
                return d;
              }
            };
            Array.forEach(tabs, tab.init);
          })();
//          remoteData({"status":"success","msgTimeStamp":1333752423706,"data":{"selected":105933,"redeemed":88278,"guests in queue":370,"participants":76741}});
        </script>
        <div class="vag bk offersets col">
          <div class="offerset">
            <h2>Offersets</h2>
            <div class="option a">
              <h3><span>Morning</span></h3>
              <div class="progress"><div class="full" style="width: 0;">&nbsp;</div><label style="font-weight: normal;"><span num="9" bind="a_percent">&nbsp;</span>%</label></div>
              <div class="values"><span num="7" bind="a_redeemed">&nbsp;</span> redeemed / <span num="8" bind="a_selected">&nbsp;</span> selected</div>
            </div>
            <div class="option b">
              <h3><span>Mid day</span></h3>
              <div class="progress"><div class="full" style="width: 0;">&nbsp;</div><label style="font-weight: normal;"><span num="9" bind="b_percent">&nbsp;</span>%</label></div>
              <div class="values"><span num="7" bind="b_redeemed">&nbsp;</span> redeemed / <span num="8" bind="b_selected">&nbsp;</span> selected</div>
            </div>
            <div class="option c">
              <h3><span>Evening</span></h3>
              <div class="progress"><div class="full" style="width: 0;">&nbsp;</div><label style="font-weight: normal;"><span num="9" bind="c_percent">&nbsp;</span>%</label></div>
              <div class="values"><span num="7" bind="c_redeemed">&nbsp;</span> redeemed / <span num="8" bind="c_selected">&nbsp;</span> selected</div>
            </div>
            <div class="option d">
              <h3><span>All day</span></h3>
              <div class="progress "><div class="full" style="width: 0;">&nbsp;</div><label style="font-weight: normal;"><span num="9" bind="d_percent">&nbsp;</span>%</label></div>
              <div class="values"><span num="7" bind="d_redeemed">&nbsp;</span> redeemed / <span num="8" bind="d_selected">&nbsp;</span> selected</div>
            </div>
          </div>
        </div>
      </div>
      <style>
      #blue,
      #entitlements {
        /*width: 820px;*/
        width: 890px;
        height: 620px;
        position: absolute;
        left: 140px;
        top: 15px;
        /*padding-left: 20px;*/
        /*padding-right: 20px;*/
      }

      #blue h3,
      #entitlements h3 {
        color: #c5c5c5;
        margin-top: 0;
        margin-bottom: 10px;
      }

      #blue  hr,
      #entitlements hr {
        background: -webkit-gradient(radial, 50% 50%, 0, 50% 50%, 400, from(#000), to(#212121));
        margin-top: 8px;
        margin-bottom: 8px;
      }

      #blue  div.progress,
      #entitlements div.progress {
        margin-right: 40px;
      }

      #blue  div.progress label,
      #entitlements div.progress label {
        font-size: 1.3em;
        margin-top: -2px;
      }

      #blue  h3.title,
      #entitlements h3.title {
        font-size: 1.5em;
        margin-top: 3px;;
        margin-bottom: 10px;
        text-align: center;
      }

      #blue  span.values,
      #entitlements span.values {
        margin-top: 1px;
        font-size: 0.8em;
        float: right;
      }

      #blue  > div.chart > div.values,
      #entitlements > div.chart > div.values {
        font-size: 1.2em;
        color: rgb(185, 185, 185);
      }

        /*#blue  div.row:last-of-type hr,
#entitlements div.row:last-of-type hr {
          display: none;
        }*/
      #blue  div.rows,
      #entitlements div.rows {
        height: 575px;
        width: 860px;
        overflow-x: hidden;
        overflow-y: scroll;
        /*overflow-y: scroll;*/
        /*overflow: scroll;*/
        -webkit-overflow-scrolling: touch;
      }

      #blue  div.rows div.row,
      #entitlements div.rows div.row {
        position: relative;
        /*top: -8px;*/
        top: 0;
        width: 785px;
        padding-left: 20px;
        padding-right: 60px;
        padding-bottom: 10px;
        height: 54px;
        margin-right: 20px;
        margin-top: 5px;
        margin-bottom: -15px;
        background-color: rgb(40, 40, 40);
        -webkit-transition: height 0.8s ease-in-out;
      }

        #entitlements div.rows div.row.open {
        overflow-x: scroll;
        -webkit-overflow-scrolling: touch;
        }
        #entitlements div.rows div.row.open,
        #entitlements div.rows div.row:hover {
          box-shadow: inset 0 0 8px black;
          background: -webkit-linear-gradient(top left, #1D1D1D 0%, #111111 100%);
        }
        #entitlements div.rows div.row:hover hr,
        #entitlements div.rows div.row.open hr,
        #entitlements div.rows div.row.open + div.row hr,
        #entitlements div.rows div.row:hover + div.row hr {
          visibility: hidden;
        }
        #reload {
          position: fixed;
          bottom: 0;
          left: 0;
          width: 60px;
          height: 60px;
          background: white;
          opacity: 0.01;
        }


        #entitlements div.rows div.row div.detail {
          -webkit-transition: height 0.8s ease-in-out, width 0.6s ease-in-out;
          height: 0;
          /*overflow: hidden;*/
          overflow: hidden;
          width: 1285px;
        }


        #entitlements div.rows div.row.open {
          height: 500px;
        }
        #entitlements div.rows div.row.open div.detail {
          overflow-x: scroll;
          overflow: scroll;
          -webkit-overflow-scrolling: touch;
          margin-top: 30px;
          height: 454px;
        }
        #entitlements div.rows div.row div.detail > div {
          height: 450px;
        }
        #entitlements > a.button.white,
        div.detail > a.button.white {
          display: inline-block;
          font-weight: normal;
          box-shadow: none;
          padding: 0 10px;
          border-radius: 0;
          border-width: 1px;
          position: absolute;
          top: 90px;
          z-index: 20;

          /*right: 9px;*/
          /*right: 39px;*/
          opacity: 0;
          transition: opacity 0.4s ease-in-out;
        }
        div.row.open div.detail > a.button.white {
          opacity: 1;
        }
        div.detail table {
          color: white;
          border-radius: 5px;
          -webkit-transition: opacity 0.4s ease-in-out;
          background-color: rgb(40, 40, 40);
          opacity: 0;
        }
        div.detail table[for="detail"] {
          /*position: absolute;*/
          width: 821px;
          /*top: 60px;*/
          z-index: -1;
          /*bottom: 120px;*/
          padding: 10px 30px 100px;
          margin-top: -1412px;
        }
        div.detail table[for="detail"] th:first-child,
        div.detail table[for="detail"] td:first-child,
        div.detail table[for="detail"] th:nth-child(2),
        div.detail table[for="detail"] td:nth-child(2) {
          display: none;
        }
        div.detail table th.button.white {
          box-shadow: none;
          padding-top: 0.2em;
          padding-bottom: 0.2em;
        }
        div.detail table th,
        div.detail table td {
          padding-top: 1em;
          text-align: center;
        }
        div.detail table td b{
          color: #090;
        }
        #entitlements div.row.open.auto {
          height: auto;
        }
        #entitlements div.row.open.auto,
        #entitlements div.row.open.auto div.detail {
          height: auto !important;
        }
        #entitlements div.row.open.auto div.detail {
          position: relative;
          top: 0;
          /*top: -430px;*/
        }
        #entitlements div.row.open.table div.chart.vertical,
        #entitlements div.row.open.table div.chart.vertical * {
        /*#entitlements div.row.open div.chart.vertical,*/
        /*#entitlements div.row.open div.chart.vertical * {*/
          opacity: 0;
          z-index: -1;
        }
        #entitlements div.row.open.table div.detail > table {
        /*#entitlements div.row.open div.detail > table {*/
          margin-top: -405px;
          opacity: 1;
          z-index: 17;
        }


/*        div.detail table tbody {
          max-height: 300px;
          overflow-y: scroll;
          -webkit-overflow-scrolling: touch;
        }
*/
        #entitlements div.chart.vertical table {
          width: 350px;
          /*padding-left: 20px;*/
          /*padding-right: 20px;*/
          padding-bottom: 40px;
          margin-left: 30px;
          height: auto;
        }
        #entitlements div.chart.vertical div.column.selected table {
          opacity: 1;

        }

        div.chart.vertical div.columns div.progress {
          width: 10px;
          /*height: 100%;*/
          height: 0;
          /*margin-bottom: 30px;*/
          position: absolute;
        }
        div.chart.vertical div.progress div.full {
          background: -webkit-gradient(linear, 0% 0%, 100% 0%, from(#93ca93), to(#009900), color-stop(0.4,#65ba65));
          width: 10px !important;
          /*height: 30%;*/
        }
        div.chart.vertical div.columns {
          position: relative;
          bottom: 0;
          height: 90%;
        }

        #entitlements div.chart.vertical div.columns div.progress label {
          margin: 5px 5px 5px -0.6em;
          position: absolute;
          bottom: 100%;
          left: 50%;
          font-size: 1.1em;
          -webkit-transition: color 0.4s easin-out;
        }
        #entitlements div.chart.vertical div.columns div.progress label.tick {
          position: absolute;
          bottom: -1.8em;
          left: 50%;
          margin-left: -1.2em;
          font-size: 1em;
        }
        div.chart.vertical div.columns > div.column:first-of-type {
        }
        div.chart.vertical div.columns > div.column {
          cursor: pointer;
          position: relative;
          height: 70%;
          bottom: -55px;
          float: left;
          padding-left: 20px;
          width: 30px;
          /*margin-bottom: 20px;*/
          /*margin-left: 50px;*/
          -webkit-transition: width 0.6s ease-in-out;
          /*-webkit-transition-property: left opacity;*/
        }
        div.detail.compact {
          width: 1285px;
        }
        div.detail.compact div.chart.vertical div.columns > div.column:not(.selected) {
          overflow: hidden;
          /*opacity: 0;*/
        }
      div.detail.compact div.chart.vertical div.columns > div.column:not(.selected) table {
        display: none;

      }

        div.detail.compact div.chart.vertical div.columns > div.column.selected {
          /*position: absolute;*/
          /*top: 55px;*/
          /*bottom: auto;*/
          /*left: 0;*/
          width: 400px;
        }

        div.chart.vertical div.columns div.column:hover label {
          color: white;
        }
       #entitlements,
       #blue {
         -webkit-transition: -webkit-transform 1s ease-in-out;
         /*opacity: 0;*/
         /*z-index: -1;*/
        }
        div.chart.vertical div.columns hr.tick {
          position: absolute;
          width: 100%;
          margin-bottom: -21px !important;
          /*background-color: gold;*/
          /*visibility: visible !important;*/
        }

        div.wrap:not([tab="blue"]) #blue,
        div.wrap:not([tab="entitlements"]) #entitlements {
          -webkit-transform: translate3d(1100px, 0, 0);
        }
        div.wrap[tab="entitlements"] #entitlements {
          /*opacity: 1;*/
          /*z-index: 75;*/
          /*visibility: visible;*/
        }
      div.micro,
      div.micro div.chart.vertical {
          height: 100px !important;/*needed for queue counters*/
      }
      div.micro div.chart.vertical div.columns > div.column label {
        visibility: hidden;
        display: none;
      }
      div.micro div.chart.vertical div.columns > div.column {
        cursor: pointer;
        position: relative;
        height: 70%;
        bottom: -55px;
        float: left;
        padding-left: 0;
        /*width: 8px;*/
        width: 10px;
        /*margin-bottom: 20px;*/
        /*margin-left: 50px;*/
        -webkit-transition: width 0.6s ease-in-out;
        /*-webkit-transition-property: left opacity;*/
      }
      .micro div.chart.vertical div.columns > div.column div.full,
      .micro div.chart.vertical div.columns > div.column div.progress {
        width: 5px !important;
      }
      div.micro div.chart.vertical div.columns > div.column:nth-child(4n) {
        /*margin-left: 3px;*/
        margin-right: 20px;
      }
      div.micro div.chart.vertical div.columns > div.column:first-child label.tick,
      div.micro div.chart.vertical div.columns > div.column:nth-child(4n+1) label.tick {
          visibility: visible;
          display: inline;
          /*position: relative;*/
          left: -10px;
          bottom: -2.2em;
          color: #090 !important;
        }
        div.micro div.chart.vertical div.columns > div.column:first-child label.tick:before,
        div.micro div.chart.vertical div.columns > div.column:nth-child(4n+1) label.tick:before {
          content: '.';
          color: #c5c5c5;
          position: absolute;
          top: -1.1em;
          left: 7px;
        }
        div#hourly_target {
          width: 100px;
          overflow: visible;
          margin-top: -50px;
        }
        div#hourly_target div.chart {
          width: 250px;
          overflow: visible;
        }
        div#hourly_target div.chart label {
          font-size: 0.9em;
        }
        div#hourly_target.micro div.chart.vertical div.column div.progress:before {
          content: attr(max);
          position: relative;
          top: -20px;
          color: #c5c5c5;
          font-size: 0.85em;
        }
        div#hourly_target.micro:hover div.chart.vertical div.column div.progress:before {
          /*content: '';*/
        }
        div#hourly_target.micro div.chart.vertical div.column:hover div.progress:before {
          content: attr(values);
        }



      </style>
      <div id="reload">&nbsp;</div>
      <script>
        document.getElementById('reload').addEventListener(touch, function() {
          location.reload();
        });
      </script>
      <div style="display: none;" class="template_area">
        <div class="tile blank"><div>&nbsp;</div><div>&nbsp;</div><div>&nbsp;</div></div>
        <div class="flipper micro"><div class="top"></div><div class="top"></div><div class="bottom"></div><label class="insetText" bind="" num="6">&nbsp;</label><label class="insetText">&nbsp;</label><div class="crease"><span class="hinge">hinge</span><span class="hinge">hinge</span></div><hr /></div>
        <div class="row" id="entitlements_facility_base">
          <hr />
          <div class="top">
            <h3>name<span class="values"><span num="12" bind="iter_part">&nbsp;</span> / <span num="13" bind="iter_whole">&nbsp;</span></span></h3>
            <div class="progress "><div class="full">&nbsp;</div><label><span num="14" bind="iter_percent">&nbsp;</span>%</label></div>
          </div>
          <div class="detail table"><div class="chart vertical"><div class="columns">
            <!--<div class="column" for="0800"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">0800</label></div></div>-->
            <div class="column" for="0900"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">0900</label></div></div>
            <div class="column" for="1000"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">1000</label></div></div>
            <div class="column" for="1100"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">1100</label></div></div>
            <div class="column" for="1200"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">1200</label></div></div>
            <div class="column" for="1300"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">1300</label></div></div>
            <div class="column" for="1400"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">1400</label></div></div>
            <div class="column" for="1500"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">1500</label></div></div>
            <div class="column" for="1600"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">1600</label></div></div>
            <div class="column" for="1700"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">1700</label></div></div>
            <div class="column" for="1800"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">1800</label></div></div>
            <div class="column" for="1900"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">1900</label></div></div>
            <div class="column" for="2000"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">2000</label></div></div>
            <div class="column" for="2100"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">2100</label></div></div>
            <div class="column" for="2200"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">2200</label></div></div>
            <div class="column" for="2300"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">2300</label></div></div>
            <!--<div class="column" for="2400"><div class="progress "><div class="full">&nbsp;</div><label><span num="15" bind="inner_percent">&nbsp;</span>%</label><label class="tick">2400</label></div></div>-->
          </div></div></div>
        </div>
        <div class="row" id="blue_facility_base">
          <hr />
          <h3>Space Mountain<span class="values"><span num="22" bind="iter_part">&nbsp;</span> / <span num="21" bind="iter_whole">&nbsp;</span></span></h3>
          <div class="progress "><div class="full">&nbsp;</div><label><span num="23" bind="iter_percent">&nbsp;</span>%</label></div>
        </div>
      </div>
      <script>
        (function () {
          config.facilities.fetch('', false, config.facilities.render);
        })();
      </script>
      <div id="entitlements" class="bk">
        <h3 class="title">FastPass+</h3>

        <div class="chart">
        <div class="rows bk" id="entitlements_target">
        </div>
        <div class="values" style="float:right;margin-top:12px;margin-right:30px;"><span>redeemed</span> / <span>selected</span></div>
      </div>
      </div>
      <style>
        div.reasons {
          z-index: 2500;
          position: absolute;
          top: 0;
          right: 20px;
          width: 300px;
          -webkit-transition: -webkit-transform 0.4s ease-in-out;
          -webkit-transform: translate3d(230px, 0, 0);
        }
        div.reasons.out {
          -webkit-transform: translate3d(0, 0, 0);
        }
        div.reasons > div {
          float: right;
        }
        div.reasons td {
          color: white;
        }
        div.reasons th {
          color: rgb(185, 185, 185);
        }
        div.reasons a.button.white {
          font-size: 0.9em;
          border-radius: 0;
          box-shadow: none;
          border-width: 1px;
          font-weight: normal;
          padding: 0.5em;
          padding-top: 0.1em;
          padding-bottom: 0.1em;
        }
      </style>
      <div id="blue" class="bk">
      <h3 class="title">Overrides / Occurrences</h3>
        <div class="reasons">
          <a class="button white">Reasons</a>
          <div class="bk">
            <table class="reasons">
              <tbody>
              <tr><th>Already Redeemed</th><td num="24" bind="Already Redeemed">&nbsp;</td></tr>
              <tr><th>Early</th><td num="24" bind="Early">&nbsp;</td></tr>
              <tr><th>Late</th><td num="24" bind="Late">&nbsp;</td></tr>
              <tr><th>No Xpass</th><td num="24" bind="No Xpass">&nbsp;</td></tr>
              <tr><th>Wrong Experience</th><td num="24" bind="Wrong Experience">&nbsp;</td></tr>
              </tbody>
            </table>
          </div>
        </div>
        <script>
          document.body.querySelector('#blue div.reasons a.button.white').addEventListener('click', function() {
            document.body.querySelector('div.reasons').classList.toggle('out');
          });
        </script>

      <div class="chart">
      <div class="rows bk" id="blue_target">
      </div>
      <div class="values" style="float:right;margin-top:12px;margin-right:30px;"><span>overrides</span> / <span>occurrences</span></div>
      </div>
      </div>




      <script>
        (function() {
          window.table = function(headers, props, data, visitor) {
            var r = document.createElement('table');
            var thead = document.createElement('thead');
            var header = document.createElement('tr');
            thead.appendChild(header);
            var tbody = document.createElement('tbody');
            var tr = document.createElement('tr');
            headers.forEach(function(prop) {
              var th = document.createElement('th');
              th.classList.add('button');
              th.classList.add('white');
              th.appendChild(document.createTextNode(prop));
              //todo: add clicks
              header.appendChild(th);
              var td = document.createElement('td');
              td.appendChild(document.createTextNode('\u00a0'));//nbsp;
              tr.appendChild(td);
            });
            data.forEach(function(row) {
              var clone = tr.cloneNode(true);
              //todo: add clicks
              if (props.length === clone.cells.length) {
                props.forEach(function(prop, index) {
                  clone.cells[index].firstChild.nodeValue = row[prop];
                });
              } else {
                console.log('lengths are not equal', props.length, clone.cellls.length);
              }
              tbody.appendChild(clone);
              var visit = visitor && visitor(clone, row);
            });
            r.appendChild(thead);
            r.appendChild(tbody);
            return r;
          };
          var entitlements = document.getElementById('entitlements');
          var rows = document.body.querySelectorAll('#entitlements > div.chart > div.rows > div.row');
          var current;
          window.queryDirectChildrenBySelector = function(element, selector) {
            var r = null;
            var all = element.querySelectorAll(selector);
            var pn = element;
            Array.forEach(all || [], function(child) {
              if (pn === child.parentNode) {
                r = r || [];
                r.push(child);
              }
            });
            return r;
          };
          var foo = function(body) {
            if (body.status === 'success') {
              var data = body.data.data;
              var max = Math.max.apply(Math, data.map(function(item) {
                return item.selectedEntitlements
              }));
              var updateRow = function(row, item) {
                var data = {
                  iter_part: item.redeemedEntitlements,
                  iter_whole: item.selectedEntitlements,
                  iter_percent: Math.round(100 * item.redeemedEntitlements / item.selectedEntitlements)
                };
                var progress = row.querySelector('div.progress');
                progress.style.width = Math.round(100 * item.selectedEntitlements/max) + '%';
                progress.firstChild.style.width = (data.iter_percent > 100 ? 100 : data.iter_percent) + '%';
                Array.forEach(row.querySelectorAll('*[bind]'), function(element) {
                  var fs = element.firstChild;
                  fs.nodeValue = data[element.getAttribute('bind')] || fs.nodeValue;
                });
              };
              data.forEach(function(item) {
                var facility = item.attraction.replace('\u0027', "'");
                var row = entitlements.querySelector('div.rows > div[for="' + facility + '"]');
                updateRow(row, item);
              });

            }
          };

        })();
      </script>
      <div id="dozen" class="bk">
        <h2>March</h2>
        <label>Sun</label><label>Mon</label><label>Tue</label><label>Wed</label><label>Thu</label><label>Fri</label><label>Sat</label>
      </div>
      <script>
        (function() {
          var monthPending;
          window.calendar = {};
          calendar.stage = function(month) {
            if (month) {
              monthPending = month;
            }
            return monthPending;
          };
          calendar.data = [];
          calendar.data.exec = {};
          calendar.data.entitlements = {};
          calendar.data.blue = {};
          calendar.data.guests = {};
          calendar.today = new Date();
//          calendar.today.setDate(calendar.today.getDate() - 65); //todo: remove this
          calendar.future = new Date(calendar.today);
          calendar.future.setDate(calendar.future.getDate() + 20);
          calendar.yesterday = new Date(calendar.today);
//          calendar.today.setMonth(2);//todo: remove this
          calendar.month = calendar.today.getMonth();
//          calendar.yesterday.setMonth(2);//todo: remove this
          calendar.yesterday.setDate(calendar.yesterday.getDate() - 1);
          calendar.date = {
            equals: function(a, b) {
              return calendar.date.toString(a) === calendar.date.toString(b);
            },
            readTime: function(time) {
//              2012-07-31 11:45:21.36  //old (/\d\d?\:\d\d\:\d\d\s[AP]M*/$/
              return ((/\d\d\d\d\-\d\d\-\d\d\s(\d?\d\:\d\d:\d\d)\.?\d{0,3}$/.exec(time) || ['', ''])[1] || '').replace(/\:\d\d\s/, ' ');
            },
            toString: function(date) {
              return [date.getFullYear(), date.getMonth() + 1, date.getDate()].join('-');
            }
          };
          calendar.months = 'January|February|March|April|May|June|July|August|September|October|November|December'.split('|');
        })();
      setTimeout(function() {
          var blob = {"status": "success", "msgTimeStamp": 1332452686846, "data": {"selected": 1461, "redeemed": 1290, "guests in queue": 2397, "participants": 3508}};
          var dozen = document.getElementById('dozen');
          var d;
          var today = calendar.today;
          var month = calendar.month;
          calendar.previous = function() {
            calendar.load(--calendar.month);
          };
          calendar.next = function() {
            if (today.getMonth() !== calendar.month) {
              calendar.load(++calendar.month);
            }
          };
         var heading = dozen.querySelector('h2');
        heading.addEventListener(touch, calendar.previous, false);
          var yesterday = calendar.yesterday;
          var day = new Date(calendar.today);
          day.setDate(1);
          day.setDate(-day.getDay());
          var future;
          var click = function(e) {
            var current = dozen.querySelector('div.donut.selected');
            var getTabs = function() {
              return document.body.querySelectorAll('div.wrap div.time_picker > div');
            };
            var tabs = getTabs();
            var element = this;
            var d = calendar.date.toString(new Date(element.getAttribute('day')));
            var yesterday = calendar.yesterday;
            var map = {};
            map[calendar.date.toString(today)] = function() {
              tab.click(document.body.querySelector('div.wrap div.time_picker > div[for="today"]'), e);
            };
            map[calendar.date.toString(yesterday)] = function() {
              tab.click(document.body.querySelector('div.wrap div.time_picker > div[for="yesterday"]'), e);
            };
            var next = function() {
              var tabs = getTabs();
              var t = tabs[tabs.length - 1];
              t.setAttribute('day', element.getAttribute('day'));
              tab.click(t, e);
              var text = t.lastChild && (t.lastChild.nodeValue = (/\w{3}\s\d{2}/.exec(element.getAttribute('day')) || [])[0]);
            };
            if (map[d]){
              map[d]();
            } else if (tabs.length === initialPickerLength) {
              var n = tabs[0].cloneNode(true);
              tabs[0].parentNode.appendChild(n);
              tab.init(n);
              n.removeAttribute('show');
              n.setAttribute('for', 'custom');
              next();
            } else {
              next();
            }
            if (current !== this) {
              var remove = current && current.classList.remove('selected');
              this.classList.add('selected');
            }

          };
          calendar.render = function() {
            var count = 42;
            dozen.querySelector('h2').firstChild.nodeValue = calendar.months[today.getMonth()];
            while (count--) {
//            window.setTimeout(function() {
              (function () {
                blob.data.selected = Math.random() * 1500;
                blob.data.redeemed = blob.data.selected - (Math.random() * (blob.data.selected / 2));
                d = donut.make(dozen, null/*blob*/, { radius: 18 });
                day.setDate(day.getDate() + 1);
                d.setAttribute('day', day);
//              d.addEventListener('touchmove', click);
                if (day.getMonth() !== month) {
                  d.classList.add('dim');
                }
                d.querySelector('div.hole div.values div[bind="redeemed percent"]').firstChild.nodeValue = day.getDate();
                if (false && future) {
                  //todo: add this back in
//                  d.classList.add(future);

                } else {
                  d.classList.add('selectable');
                  d.addEventListener(touch, click, false);
//                d.addEventListener('touchstart', click, false);
                  /*d.querySelector('div.hole').addEventListener('touchstart', function(e) {
                   click.apply(d, e);
                   }, false);*/
                }
                if (calendar.date.equals(day, today)) {
                  d.classList.add('today');
                  d.classList.add('selected');
                  future = 'future'
                }
                d.style['float'] = 'left';
              })();
//            }, count * 2 + 30);
            }
          };
          calendar.load = function(month) {
            var stt = new Date();
            month = month === undefined ? calendar.stage() : month;
            var day = new Date();
            day.setMonth(month);
            calendar.title = calendar.title || dozen.querySelector('h2').firstChild;
            calendar.title.nodeValue = calendar.months[day.getMonth()];
            day.setDate(1);
            day.setDate(-day.getDay());
            var future;
            var max = 42;
            var count = 42;
            var days = dozen.querySelectorAll('div.donut');
            ['today', 'selected'].forEach(function(item) {
              var element = dozen.querySelector('div.' + item);
              var remove = element && element.classList.remove(item);
            });
            var h = calendar.data.exec;
            donut.order = function(element, date, delay) {
              var r = function() {
                clearTimeout(timer);
                var row = h[date] || [0, 0];
                donut(element.querySelector('canvas'), { radius: 18 }).draw(Math.round(row[0]/row[1] * 100));
              };
              var timer = setTimeout(r, delay || 0);
              return r;
            };
            while (count) {
//            window.setTimeout(function() {
              (function () {
//                blob.data.selected = Math.random() * 1500;
//                blob.data.redeemed = blob.data.selected - (Math.random() * (blob.data.selected / 2));
                var element = days[max - count];
                day.setDate(day.getDate() + 1);
//                donut(element.querySelector('canvas'), { radius: 18 }).draw(blob.data['redeemed percent']);
                donut.order(element, calendar.date.toString(day), 100);
                var row = h[calendar.date.toString(day)] || [0, 0];
//                donut(element.querySelector('canvas'), { radius: 18 }).draw(Math.round(row[0]/row[1] * 100));
                element.setAttribute('day', day);
//              d.addEventListener('touchmove', click);
                if (day.getMonth() !== month) {
                  element.classList.add('dim');
                } else {
                  element.classList.remove('dim');
                }
                element.querySelector('div.hole div.values div[bind="redeemed percent"]').firstChild.nodeValue = day.getDate();
                //todo: what about counts that don't have redeemed/selected
                if (future  || row.join('') === '00') {
                  element.classList.add('future');
                  element.classList.remove('selectable');
                  //todo: add this back
//                  element.removeEventListener(touch, click);
                } else {
                  element.classList.remove('future');
                  element.classList.add('selectable');
                  element.addEventListener(touch, click, false);
//                d.addEventListener('touchstart', click, false);
                  /*d.querySelector('div.hole').addEventListener('touchstart', function(e) {
                   click.apply(d, e);
                   }, false);*/
                }
                if (calendar.date.equals(day, today)) {
                  element.classList.add('today');
                  element.classList.add('selected');
                  //todo: add this back in
                  //future = 'future'
                }
                d.style['float'] = 'left';
              })();
              count--;
//            }, count * 2 + 30);
            }
//            console.log(new Date() - stt, new Date());
          };
        var iStart = new Date();
//        console.log('pre render');
        calendar.render();
//        console.log('post render', new Date() - iStart, document.body.querySelectorAll('div.hole').length);
        if (calendar.stage()) {
          setTimeout(function() {
            calendar.load(calendar.month);
          }, 200);
        }
        }, 700);
      </script>
        <!--<script src="http://twinkle.local:8080/xi/dashboard/execsummary?foo"></script>-->
    </div>
    <style>
      #guests_target,
      #guest {
        width: 1034px;
        height: 748px;
        /*overflow-x: hidden;*/
        /*overflow-y: scroll;*/
        overflow: scroll;
        position: absolute;
        top: 0;
        left: 0;
        /*-webkit-transform: translate3d(-1100px, 0, 0);*/
        -webkit-transform: translate3d(0, -750px, 0);
        -webkit-transition: -webkit-transform 0.6s ease-in-out;
        /*-webkit-transform: translate3d(0, 0, 0);*/
        z-index: 2500 !important;
      }
      #guests_target {
        -webkit-transform: translate3d(0, -810px, 0);
        overflow: auto;
        padding-top: 60px;
        z-index: 2499 !important;
      }
      /*#guest:hover,*/
      #guests_target.shown,
      #guest.shown {
        -webkit-transform: translate3d(0, 0, 0);
      }
      #guests_target table,
      #guest table {
        color: white;
        width: 100%;
      }
      #guests_target table thead,
      #guest table thead {
        color: rgb(185, 185, 185);
        width: 100%;
      }
      #guests_target table tbody,
      #guest table tbody {
        text-align: right;
      }
      #guest table tbody td {
        position: relative;
        left: -40px;
      }
      #guest > h2 {
        text-align: center;
        font-size: 3em;
        color: white;
      }
      #guest  th h3 {
        font-size: 2em;
      }
      #guest hr {
        background: -webkit-gradient(radial, 50% 50%, 0, 50% 50%, 300, from(#000), to(#212121));
      }
      #guest .bar {
        margin-left: 50%;
        position: relative;
        left: -20px;
        padding: 0.3em 1em;
      }

    </style>
    <div id="guests_target" class="vag bk" for="search"><div class="close" onclick="this.parentNode.classList.remove('shown');nav.click.apply(document.getElementById('exec_nav'));">&times;</div></div>
    <div id="guest" class="vag bk">
      <h2>Email: <span num="" bind="email">&nbsp;</span></h2>
      <table>
        <thead>
        <tr><th colspan="3"><hr /><h3>Entitlements</h3></th></tr>
        <tr><th>Facility</th><th>Window</th><th>Status</th></tr>
        </thead>
        <tbody><tr><td>1</td><td>2</td><td>3</td></tr></tbody>
        <thead>
        <tr><th colspan="3"><hr /><h3>Reads</h3></th></tr>
        <tr><th>Time</th><th>Ride queue</th><th>Location</th></tr>
        </thead>
        <tbody><tr><td>1</td><td>2</td><td>3</td></tr></tbody>
        <thead>
        <tr><th colspan="3"><hr /><h3>Experiences</h3></th></tr>
        <tr><th>Time</th><th>Ride queue</th><th>Wait</th></tr>
        </thead>
        <tbody><tr><td>1</td><td>2</td><td>3</td></tr></tbody>
      </table>
      <hr />
      <a onclick="document.getElementById('guest').classList.remove('shown');" class="button white bar">Done</a>
      <br/>
      <br/>
    </div>
    <style>
      div.close {
        position: absolute;
        /*bottom: 10px;*/
        top: 10px;
        right: 10px;
        font-size: 3em;
        cursor: pointer;
        /*height: 32px;*/
        /*width: 32px;*/
        color: #c5c5c5;
        border-radius: 50%;
        border: 3px solid #c5c5c5;
        padding: 3px 4px 8px;
      }
    </style>
    <div id="queue_counters"><div class="close" onclick="this.parentNode.classList.remove('shown');">&times;</div></div>

    <script>
      window.counters = {
        init: function (queues) {
          var qcs = document.getElementById('queue_counters');
          var base = document.querySelector('div.template_area div.flipper');
          queues.forEach(function(item) {
            var c = base.cloneNode(true);
            var name = item.shortName;
            var wrap = document.createElement('div');
            wrap.addEventListener(window.touch, function(e) {
              tiles.reset(subways[name]);
              setTimeout(function() {
                counts.update(name);
              }, 100);
//              console.log(item, subway[item.facilityId]);
              document.querySelector('#subway_panel > #subway').setAttribute('for', name);
              document.body.classList.remove('hide_subway_panel');
            }, false);
            wrap.className = 'queue_counter';
            wrap.appendChild(c);
            wrap.appendChild(document.createTextNode('\u00a0')); //nbsp;
            wrap.setAttribute('for', name);
            c.setAttribute('for', name);
            /*setTimeout(function() {
              flip(Math.floor(Math.random() * 100), 'div.flipper[for="' + name + '"]');
            }, 300);*/
            wrap.style['background-image'] = 'url(logos/' + name + '.png)';
            qcs.appendChild(wrap);
          });
        },
        update: function(data) {
          if (window.idToNick) {
            var counts;
            var total;
            window.grandTotal = 0;
            for (var k in data) {
              counts = data[k];
              total = ('fp_entry' in counts ? counts.fp_entry : counts.entry);// + counts.merge * 1;
              grandTotal += total;
              flip(total || 0, 'div.flipper[for="' + idToNick(k) + '"]');
            }
            flip(grandTotal);
          }
        }
      };
      window.hourly = {
        load: function(data) {
          var hours = document.querySelectorAll('#hourly_target #hourly div.progress');
          var max = Math.max.apply(Math, data.map(function(hour) {
            return hour.selected;
          }));
          data.forEach(function(hour, i) {
            var element = hours[i];
            element.setAttribute('values', [hour.redeemed, hour.selected].join('/'));
            element.setAttribute('max', ' ');
            element.style.height = (max ? (Math.round(100 * hour.selected / max)) : 0) + '%';
            element.querySelector('div.full').style.height = (hour.redeemed && hour.selected ? (Math.round(100 * hour.redeemed / hour.selected)) : 0) + '%';
            if (max && hour.selected === max) {
              element.setAttribute('max', [hour.redeemed, hour.selected].join('/'));
            }
          });
        }
      };
      setTimeout(function() {
        //todo: always call hourly load before exec.force and cache hourly
//        hourly.load([{"selected":86,"redeemed":0,"hour":8},{"selected":770,"redeemed":40,"hour":9},{"selected":855,"redeemed":375,"hour":10},{"selected":932,"redeemed":324,"hour":11},{"selected":1046,"redeemed":390,"hour":12},{"selected":1024,"redeemed":467,"hour":13},{"selected":1367,"redeemed":395,"hour":14},{"selected":806,"redeemed":313,"hour":15},{"selected":693,"redeemed":179,"hour":16},{"selected":553,"redeemed":211,"hour":17},{"selected":337,"redeemed":114,"hour":18},{"selected":300,"redeemed":73,"hour":19},{"selected":43,"redeemed":39,"hour":20},{"selected":0,"redeemed":0,"hour":21},{"selected":0,"redeemed":0,"hour":22},{"selected":0,"redeemed":0,"hour":23},{"selected":0,"redeemed":0,"hour":24}]);
      }, 2000)
    </script>
    <style>
    div.tile {
      -webkit-user-select: none;
      -khtml-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      -o-user-select: none;
      user-select: none;
      position: relative;
      float: left;
      height: 24px;
      width: 24px;
      border: 1px solid transparent;
      -webkit-background-size: 100%;
      background-repeat: no-repeat;
      top: 0;
      left: 0;
    }
    div.tile:nth-child(20n+1) {
      clear: left;
    }
    #subway.lines div.tile {
      border-top: 1px solid #444;
      border-left: 1px solid #444;
      margin-top: -1px;
      margin-left: -1px;
    }
    #subway div.tile.selected,
    #subway.lines div.tile.selected {
      border: 1px solid rgba(255, 255, 255, 0.8);
      border-radius: 14px;
    }
    div.tile {
      -webkit-user-select: none;
      -moz-user-select: none;
      border-width: 0;
      height: 48px;
      width: 48px;
      float: left;
    }
    div.tile div:first-child,
    div.tile div:last-of-type {
      height: 12px;
    }
    div.tile div:nth-child(2) {
      height: 50%;
    }
    div.tile > div:first-child,
    div.tile > div:last-of-type {
      margin-left:25%;
      width: 50%;
    }

    div.tile.blank > div,
    div.tile.sw div:first-child,
    div.tile.se div:first-child,
    div.tile.sew div:first-child,
    div.tile.e div:first-child,
    div.tile.w div:first-child,
    div.tile.ew div:first-child {
      background-color: transparent;
    }
    div.tile.sw div:nth-child(2),
    div.tile.se div:nth-child(2),
    div.tile.nsw div:nth-child(2),
    div.tile.nse div:nth-child(2) {
      width: 75%;
    }
    div.tile.se div:nth-child(2),
    div.tile.nse div:nth-child(2),
    div.tile.ne div:nth-child(2),
    div.tile.n div:nth-child(2),
    div.tile.s div:nth-child(2),
    div.tile.ns div:nth-child(2) {
      margin-left: 25%;
    }
    div.tile > div,
    div.tile.nsw div:first-child,
    div.tile.nse div:first-child,
    div.tile.nsew div:first-child {
      background-color: #68686a;
    }
    div.tile.fp > div,
    div.tile.fpg > div,
    div.tile.fp.nsw div:first-child,
    div.tile.fp.nse div:first-child,
    div.tile.fp.nsew div:first-child {
      background-color: #090;
    }
    div.tile.n div:nth-child(2),
    div.tile.s div:nth-child(2),
    div.tile.nw div:nth-child(2),
    div.tile.ns div:nth-child(2) {
      margin-right: 25%;
    }
    div.tile.nw div:last-of-type,
    div.tile.ne div:last-of-type,
    div.tile.new div:last-of-type,
    div.tile.e div:last-of-type,
    div.tile.w div:last-of-type,
    div.tile.ew div:last-of-type {
      background-color: transparent;
    }
    div.tile div {
      font-size: 0.6em;
      color: white;
    }
    div.tile div b {
      font-size: 0.6em;
      height: 1px;
      overflow: visible;
    }
    div.tile.fp_entry,
    div.tile.entry,
    div.tile.merge,
    div.tile.queue,
    div.tile.load,
    div.tile.media,
    div.tile.exit {
      z-index: 1;
    }
    div.tile.g div:nth-child(2),
    div.tile.fpg div:nth-child(2) {
      background-size: 1.45em;
      background-position: 75%;
      background-repeat: no-repeat;
    }
    #subway_panel > #subway div.tile.g div:nth-child(2),
    #subway_panel > #subway div.tile.fpg div:nth-child(2) {
      -webkit-transition: background-size 0.25s ease-out;
    }
    div.tile.g.updating div:nth-child(2),
    div.tile.fpg.updating div:nth-child(2) {
      background-size: 0.5em;
    }
    div.tile.g div:nth-child(2):after,
    div.tile.fpg div:nth-child(2):after {
      position: absolute;
      top: 40%;
      left: 25%;
      content: attr(count);
      font-size: 0.7em;
    }
    div.tile.g div:nth-child(2)[count="0"]:after,
    div.tile.fpg div:nth-child(2)[count="0"]:after {
      color: transparent;
      content: ' ';
    }
    div.tile.g div:nth-child(2)[count="0"],
    div.tile.fpg div:nth-child(2)[count="0"] {
      /*background-image: none;*/
    }
    div.tile.ns.g div:nth-child(2),
    div.tile.ns.fpg div:nth-child(2) {
      background-position: 90%;
    }
    div.tile.ns.g div:nth-child(2):after,
    div.tile.ns.fpg div:nth-child(2):after {
      left: 30%;
    }
    div.tile.e.g div:nth-child(2):after,
    div.tile.e.fpg div:nth-child(2):after,
    div.tile.ew.g div:nth-child(2):after,
    div.tile.ew.fpg div:nth-child(2):after,
    div.tile.w.g div:nth-child(2):after,
    div.tile.w.fpg div:nth-child(2):after {
      left: 30%;
    }
    div.tile.sw.g div:nth-child(2),
    div.tile.sw.fpg div:nth-child(2) {
      background-position: 90%;
    }
    div.tile.nsw.g div:nth-child(2),
    div.tile.nsw.fpg div:nth-child(2) {
      background-position: 90%;
    }
    div.tile.se.g div:nth-child(2):after,
    div.tile.se.fpg div:nth-child(2):after {
      left: 40%;
    }
    div.tile.fpg div:nth-child(2):after {
      color: yellow;
    }
    div.tile.g div:nth-child(2) {
      background-image: url(data:image/png;base64,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);
    }
    div.tile.fpg div:nth-child(2) {
      background-image: url(data:image/png;base64,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);
    }
    div.tile.empty div {
      visibility: hidden;
    }
    div.tile.fp_entry div:nth-child(n+2),
    div.tile.entry div:nth-child(n+2),
    div.tile.merge div:nth-child(n+2),
    div.tile.queue div:nth-child(n+2),
    div.tile.media div:nth-child(n+2),
    div.tile.load div:nth-child(n+2),
    div.tile.exit div:nth-child(n+2) {
      display: none;
    }
    div.thumbs {
      position: absolute;
      top: 0;
      z-index: 2500;
      padding-top: 35px;
      /*padding-right: 54px;*/
      width: 1006px;
      background-color: rgb(40, 40, 40);
      -webkit-transform: translate3d(0, -541px, 0);
      -webkit-transition: all  0.4s ease-in-out;
    }
    body.thumbs div.thumbs {
      -webkit-transform: translate3d(0, 0, 0);
    }
    div.thumbs div.thumb {
      -webkit-transform: scale(0.25);
      -moz-transform: scale(0.25);
      transform: scale(0.25);
      margin: -238px -360px -243px;
    }
    div.thumbs div.thumb {
      float: left;
    }
    div.thumbs div.thumb:nth-child(4n+1) {
      clear: left;
    }
    div.thumbs div.thumb div.bk {
      background-color: rgba(40, 40, 40, 0.65);
    }
    div.thumbs div.thumb div.tile {
      background-color: transparent;
    }

    #subway {
      -webkit-user-select: none;
      -khtml-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      -o-user-select: none;
      user-select: none;
    }
    #subway_panel > #subway {
      margin-top: 40px;
      font-size: 1.4em;
    }
    #direction {
      opacity: 0.01;
      position: absolute;
      top: 0.25in;
      right: 0.25in;
      font-size: 2em;
      width: 3em;
    }
    div.tile.terminal {
      opacity: 0.25;
    }
    div.tile.good b {
      /*color: blue;*/
    }
    div.tile b + b {
      display: none;
    }
    b.step {
      font-weight: normal;
      position: absolute;
      top: 30%;
      left: 40%;
      font-size: 0.2em;
    }
    div.tile.fp_entry b.step,
    div.tile.entry b.step,
    div.tile.merge b.step,
    div.tile.load b.step,
    div.tile.media b.step,
    div.tile.exit b.step {
      visibility: hidden;
    }

    div.tile.fp_entry div:first-of-type,
    div.tile.entry div:first-of-type,
    div.tile.merge div:first-of-type,
    div.tile.queue div:first-of-type,
    div.tile.load div:first-of-type,
    div.tile.media div:first-of-type,
    div.tile.exit div:first-of-type {
      border-radius: 6px;
      padding: 8px 4px 4px;
      height: 36px;
      width: 43px;
      margin-left: 1px;
    }
    div.tile.entry div:first-of-type,
    div.tile.merge div:first-of-type,
    div.tile.queue div:first-of-type,
    div.tile.load div:first-of-type,
    div.tile.media div:first-of-type,
    div.tile.exit div:first-of-type {
      background-color: #68686a;
    }
    div.tile.fp_entry div:first-of-type {
      background: #090;
    }
    div.tile.g div:first-of-type,
    div.tile.fpg div:first-of-type,
    div.tile.fp div:first-of-type {
      color: transparent;
    }

    #direction {
      display: none;
    }
    #subway_panel {
      position: absolute;
      top: 0;
      left: 0;
      width: 1034px;
      height: 728px;
      z-index: 2400;
      -webkit-transition: all 0.6s ease-in-out;
    }
    body.hide_subway_panel #subway_panel {
      -webkit-transform: translate3d(-1040px, 0, 0);
    }

    #subway {
      background-repeat: no-repeat;
      background-size: 300px;
      background-position: 10px 10px;
      background-color: rgb(40, 40, 40);
    }
    #subway[for="buzz"] {
      background-size: 450px;
      background-position: 95% 40px;
      background-image: url('logos/buzz.png');
    }
    #subway[for="jungle"] {
      background-position: 26px 10px;
      background-image: url('logos/jungle.png');
    }
    #subway[for="phil"] {
      background-size: 370px;
      background-position: 50% 16px;
      background-image: url('logos/phil.png');
    }
    #subway[for="splash"] {
      background-size: 375px;
      background-position: 97% 20px;
      background-image: url('logos/splash.png');
    }
    #subway[for="haunted"] {
      background-position: 41% 36px;
      background-size: 178px;
      background-image: url('logos/haunted.png');
    }
    #subway[for="pan"] {
      background-size: 240px;
      background-position: 48px 3px;
      background-image: url('logos/pan.png');
    }
    #subway[for="pooh"] {
      background-size: 470px;
      background-image: url('logos/pooh.png');
    }
    #subway[for="space"] {
      background-size: 200px;
      background-position: 25% 3px;
      background-image: url('logos/space.png');
    }
    #subway[for="princess"] {
      background-size: 238px;
      background-position: 25% 0;
      background-image: url('logos/princess.png');
    }
    #subway[for="mickey"] {
      background-size: 230px;
      background-position: 57% 0;
      background-image: url('logos/mickey.png');
    }
    #subway[for="dumbo"] {
      background-size: 250px;
      background-position: 26% 48px;
      background-image: url('logos/dumbo.png');
    }
    #subway[for="btm"] {
      background-size: 286px;
      background-position: 49% 0;
      background-image: url('logos/btm.png');
    }
    #subway[for="barn"] {
      background-size: 400px;
      background-position: 25% 0;
      background-image: url('logos/barn.png');
    }
    hr.clear {
      clear: left;
      z-index: 6;
      position: absolute;
      left: 0;
      bottom: -11px;
      width: 99.5%;
      margin-left: 2px;
      border-top: 1px solid #333;
      border-left: 1px solid #333;
      border-bottom: 1px solid #222;
    }
    #controls {
      background-color: rgb(40, 40, 40);
      color: #c5c5c5;
      padding-top: 1em;
      padding-bottom: 1em;
      margin-top: -20px;
    }
    #controls a {
      margin-right: 14px;
      cursor: pointer;
      padding: 0.25em 2em;
      -webkit-transition: border 0.4s ease-in-out;
      -webkit-transition-property: color, background;
    }
    #controls a:hover {
      color: white;
    }
    #controls a.on {
      background-color: #c5c5c5;
      color: rgb(40, 40, 40);
    }
      /*#controls a.on~a {
        opacity: 0;
      }*/
    #controls a.on {
      opacity: 1;
    }
    #logo div {
      background: rgb(40, 40, 40) url('xi.png') no-repeat top left;
      height: 50px;
      width: 50px;
      border-radius: 50%;
      color: #c5c5c5;
      /*-webkit-transition: all 0.8s ease-in-out;*/
    }

    #logo.spin div {
      /*-webkit-animation-name: rotate;*/
      /*-webkit-animation-duration: 40000ms;  40 seconds*/
      /*-webkit-animation-iteration-count: infinite;*/
      /*-webkit-animation-timing-function: linear;*/
      /*-webkit-transform: rotate(90deg);*/
    }
    #logo {
      /*background: rgb(40, 40, 40) url('xi.png') no-repeat top left;*/
      height: 50px;
      width: 50px;
      border-radius: 50%;
      color: #c5c5c5;
      font-size: 0.8em;
      position: absolute;
      top: 25px;
      left: 20px;
      z-index: 500;
      -webkit-transition: all  0.4s ease-in-out;
    }
    #logo span {
      white-space: nowrap;
      position: absolute;
      left: 100%;
      top: -4px;
      background-color: rgb(40, 40, 40);
    }
    body.thumbs #logo {
      -webkit-transform: translate3d(0, 520px, 0);
    }
/*    #metrics {
      position: absolute;
      right: 10px;
      bottom: 10px;
    }
    #metrics div.flipper {
      bottom: 0;
      margin-bottom: 31px;
    }*/
    </style>
    <div id="subway_panel" class="bk">
      <div id="logo" class="spin"><div>&nbsp;</div><span>xi Powered by xConnect.</span></div>
      <div id="subway" class="bk"><hr style="visibility: hidden;clear:both;"></div>
      <div id="controls"></div>
      <!--<div id="metrics"></div>-->
      <div class="close" onclick="document.body.classList.add('hide_subway_panel');">&times;</div>
    </div>
    <script>
    (function () {
      (function () {
        return;
        var metrics = document.getElementById('metrics');
        (function () {
          var f = document.querySelector('div.template_area div.flipper').cloneNode(true);
          f.classList.remove('micro');
          metrics.appendChild(f);
        })();
        var d = donut.make(metrics);
        var data = {
          redeemed: 30,
          selected: 90
        };
        data['redeemed percent'] = Math.round(data.redeemed/data.selected * 100);
        donut(metrics.querySelector('canvas')).draw(data['redeemed percent']);
        var binds = metrics.querySelectorAll('*[bind]');
        Array.forEach(binds, function (element) {
          var prop = element.getAttribute('bind');
          var set = prop in data && (element.firstChild.nodeValue = data[prop]);
        });
      })();
      var blank = document.querySelector('div.template_area div.tile.blank');
      blank.parentNode.removeChild(blank);
      var grid = {
        height: 12,
        width: 20,
        tile: {
          width: 48,
          height: 48
        }
      };
      var Tile;
      var directions = ['blank', 'ew', 'ns', 'se', 'sw', 'nw', 'ne', 'new', 'sew', 'nse', 'nsw', 'n', 's', 'e', 'w', 'nsew'];
      var objects = ['empty', 'fp', 'fp_entry', 'fpg', 'entry', 'g', 'merge', 'load', 'media', 'queue', 'exit'];
      (function () {
        var click = 'click';
        var move = 'mousemove';
        Tile = {
          change: function (tile, direction, auto) {
            var cl = tile.classList;
            if (!auto && cl.contains('blank')) {
              cl.remove('blank');
            } else {
              directions.forEach(function (item) {
                cl.remove(item);
              });
            }
            direction = direction || Tile.calculateDirection(tile, true);
            var add = direction && (tile.setAttribute('shape', direction) + '1') && cl.add(direction);
            return tile;
          },
          make: function (direction) {
            var t = blank.cloneNode(true);
            setTimeout(function () {
              t.addEventListener('dragstart', function (e) {
                e.preventDefault();
                e.stopPropagation();
                return false;
              }, false);
              t.addEventListener(click, function (e) {
                if (!subway.classList.contains('lines')) {
                  return;
                }
                clearTimeout(this.saver);
                if(e.altKey) {
                  clearTimeout(this.fixer);
                  (function (){
                    var linkedList = {};
                    directions.forEach(function(direction, i) {
                      linkedList[direction] = directions[i+1] || directions[0];
                    });
                    var clear = function(tile) {
                      directions.forEach(function(direction) {
                        tile.classList.remove(direction);
                      });
                    };
                    var detect = function(tile) {
                      var r;
                      directions.forEach(function(direction) {
                        if (tile.classList.contains(direction)) {
                          r = r || direction;
                        }
                      });
                      return r || 'blank';
                    };
                    var was = detect(t);
                    clear(t);
                    var shape = linkedList[was];
                    t.classList.add(shape);
                    t.setAttribute('shape', shape);
                  })();
                  tiles.save();
                } else if ((e.metaKey || e.ctrlKey) && !this.classList.contains('blank')) {
                  var index = (this.getAttribute('contents') || 0) * 1;
                  index++;
                  Tile.addChild(this, index);
                  tiles.save();
                } else {
                  Tile.change(this, e.shiftKey ? 'blank' : null);
                  if (e.shiftKey) {
                    clearTimeout(this.fixer);
//                                this.fixer = setTimeout(tiles.fix, 200);
                    this.fixer = setTimeout(function() {
                      Tile.fix(t, true);
                    }, 200);
                  }
                }
                this.saver = setTimeout(tiles.save, 5000);
              }, false);
              t.addEventListener(move, function (e) {
                if (!subway.classList.contains('lines')) {
                  return;
                }
                //console.warn(e.which, e.button, e);
                if (e.which) { // not sure about ie, breaks safari
                  clearTimeout(this.saver);
                  Tile.change(this, e.shiftKey ? 'blank' : null);
                  if (e.shiftKey) {
                    clearTimeout(this.fixer);
//                                this.fixer = setTimeout(tiles.fix, 200);
                    this.fixer = setTimeout(function() {
                      Tile.fix(t, true);
                    }, 200);
                  }
                  this.saver = setTimeout(tiles.save, 2000);
                }
              }, false);

            });
            return direction ? Tile.change(t, direction) : t;
          },
          fix: function (tile, deep) {
            if (deep) {
              Tile.change(tile, Tile.calculateDirection(tile), true);
            }
            return true;
          },
          calculateDirection: function (tile, deep) {
            if (!tile || (tile && tile.classList.contains('blank'))) {
              return 'blank';
            }
            var index = tile.getAttribute('index') * 1;
            var north = tiles[index - grid.width];
            var south = tiles[index + grid.width];
            var east = index + 1 % grid.width && tiles[index + 1];
            var west = index % grid.width && tiles[index - 1];
            var handleDirection = function (tile, direction) {
              return (tile && !tile.classList.contains('blank') && Tile.fix(tile, deep) && direction) || '';
            };
            var hd = handleDirection;
            return [hd(north, 'n'), hd(south, 's'), hd(east, 'e'), hd(west, 'w')].join('') || 'e';
          },
          addChild: function (tile, index) {
            var value = objects[index] || objects[(index = 0)];
            var fc = tile.firstChild.firstChild;
            fc.nodeValue = value.replace(/^\w+\_/, '').replace(/^\w/, function(str) {
              return str.toUpperCase();
            });
            var remove = tile.addedClass && tile.classList.remove(tile.addedClass);
            if (index === 0) {
              fc.nodeValue = '\u00A0';
              try {
                remove = tile.getAttribute('contents') && tile.removeAttribute('contents');
              } catch (ex) {
              }
            } else {
              tile.addedClass = value;
              tile.setAttribute('contents', index);
              tile.classList.add(tile.addedClass);
            }
          }
        };
      })();
      var subway = document.getElementById('subway');
      subway.style.width = (grid.width * grid.tile.width) + 'px';
      window.tiles = [];
      tiles.save = function () {
        if (subway.classList.contains('lines')) {
          location.hash = tiles.read();
        }
      };
      tiles.restore = function () {
        tiles.load(location.hash.replace(/^#/, ''));
      };
      tiles.fix = function () {
        tiles.forEach(function (tile) {
          Tile.change(tile, Tile.calculateDirection(tile));
        });
      };
      (function () {
        var find = function(attraction) {
//      var tiles = document.body.querySelectorAll('body > #subway for="' + attraction + '" div.tile.g, body > #subway div.tile.fpg');
          var tiles = document.body.querySelectorAll('#subway[for="' + attraction + '"] div.tile.g, #subway[for="' + attraction + '"] div.tile.fpg');
          return tiles || [];
        };
        var getType = function(tile, test) {
          var r;
          test = test || function() { return true };
          var parent = tile.parentNode;
          var coordinates = tile.getAttribute('coordinates').split('_');
          var x = coordinates[0] * 1;
          var y = coordinates[1] * 1;
          var last_x = grid.width - 1;
          var last_y = grid.height - 1;
          var w = x && parent.querySelector('div.tile[coordinates="' + (x - 1) + '_' + y + '"]');
          var type = w && test(w);
          var add = type && (r = type);
          var n = y && parent.querySelector('div.tile[coordinates="' + x + '_' + (y - 1) + '"]');
          type = n && test(n);
          add = type && (r = type);
          var e = x !== last_x && parent.querySelector('div.tile[coordinates="' + (x + 1) + '_' + y + '"]');
          type = e && test(e);
          add = type && (r = type);
          var s = y !== last_y && parent.querySelector('div.tile[coordinates="' + x + '_' + (y + 1) + '"]');
          type = s && test(s);
          add = type && (r = type);
          return r;
        };
        var gate = function(tile) {
          return tile.classList.contains('fp_entry') && 'fp_entry'
              || tile.classList.contains('entry') && 'entry'
              || tile.classList.contains('merge') && 'merge';
        };
        var update = function(tile, value) {
          var div = tile.querySelector('div:nth-child(2)');
          var current = div.getAttribute('count');
          if (current != value) {
            div.setAttribute('count', value);
            if (!tile.classList.contains('updating')) {
              tile.classList.add('updating');
            }
          }
          setTimeout(function() {
            tile.classList.remove('updating');
          }, 400);
        };
        window.counts = {
          update: function(attraction, data) {
            data = data || (window.subway || {})[attraction];
            var counters = {};
            if (attraction && data) {
              Array.forEach(find(attraction), function(tile) {
                var type = getType(tile, gate);
                update(tile, data[type] || 0);//'\u00a0');// nbsp;
                counters[type] = tile;
              });
            }
            return counters;
          }
        };
      })();
      (function () {
        window.codes = {};
        var base = 65;
        directions.forEach(function (direction, i) {
          var c = String.fromCharCode(base + i);
          codes[c] = direction;
          codes[direction] = c;
        });
        var base2 = 97;
        objects.forEach(function (item, i) {
          var c = String.fromCharCode(base2 + i);
          codes['_' + c] = item;
          codes[item] = '_' + c;
        });
        window.compress = function (text) {
          return text.replace(/([a-zA-Z])(\1+)/g, function (str, p1, p2) {
            return p1 + (p2.length + 1);
          });
        };
        var repeat = function (character, times) {
          var a = [];
          a.length = (times * 1) + 1;
          return a.join(character);
        };
        window.uncompress = function (text) {
          return /\d/.test(text) ? text.replace(/([a-zA-Z])(\d+)/g, function (str, p1, p2) {
            return repeat(p1, p2);
          }) : text;
        };
        tiles.read = function (compress) {
          compress = compress || compress === undefined;
          var o = [];
          var r = tiles.map(
              function (tile, i) {
                o.push(String.fromCharCode(base2 + ((tile.getAttribute('contents') || 0) * 1)));
                return codes[tile.getAttribute('shape') || 'blank'];
              }).join('') + '_' + o.join('');
          return compress ? window.compress(r) : r;
        };
        var blankState;
        tiles.init = function () {
          blankState = tiles.read();
        };
        tiles.reset = function (map) {
          var selected = subway.querySelector('div.tile.selected');
          var unselect = selected && selected.classList.remove('selected');
          var tile;
          while (tile = subway.querySelector('div.tile.terminal')) {
            tile.classList.remove('terminal');
          }
          while (tile = subway.querySelector('div.tile.good')) {
            tile.classList.remove('good');
          }
          Array.forEach(subway.querySelectorAll('div.tile[count]'), function(tile) {
            tile.removeAttribute('count');
          });
          var step;
          while (step = subway.querySelector('div.tile b.step')) {
            step.parentNode.removeChild(step);
          }
          if (map !== 'same') {
            tiles.load(map && map.replace ? map : blankState);
          }
        };
        tiles.load = function (data) {
          data = uncompress(data || blankState).split('_');
          data = { tiles: data[0], objects: data[1] };
          tiles.forEach(function (tile, i) {
            Tile.change(tile, codes[data.tiles.substr(i, 1)], true);
            Tile.addChild(tile, data.objects.substr(i, 1).charCodeAt() - base2);
          });
        };
      })();
      var i = grid.width * grid.height;
      (function () {
        var t;
        var l;
        while (i--) {
          t = Tile.make();
          subway.insertBefore(t, subway.lastChild);
          l = tiles.length;
          t.setAttribute('index', l);
          t.setAttribute('coordinates', [l % grid.width, Math.floor(l / grid.width)].join('_'));
          tiles.push(t);
        }
        tiles.init();
        (function () {
          var names = [
            'buzz',
            'jungle',
            'phil',
            'splash',
            'haunted',
            'pan',
            'pooh',
            'space',
            'princess',
            'mickey',
            'dumbo',
            'btm',
            'barn'
          ];
          var maps = [
            'A41NB2IB4EA14CDB2ECA14C2DOFGB7EA6C2GB9ECA6GFDB9FCA8CANB8FA142_a41hafgb5a19ba19b9a19ba8fa10ba8eacdb8a142',//buzz
            'A47DB2OA16CA13DB5HB5EA7CDB10FA7CGB10EA7GB2OA2NB5FA146_a50ha16fa13b6ga13ba19ba19b2dca2efa151',//jungle
            'A82DB3A16JB8EA10CADB6FA10CAGB7NEA8GB8OALA126_a82fa2ha16ga19ba19ba10fa8b8dcaea126',//phil
            'A44NB6EA19CA11DBEADBEACA9NBFACACAGBHB2OA10GBFA112_a44cdb6a19ba19ba9efa8gfaha125',//splash
            'A5DB4OA14CA5DB2OA10CA5CA13CA5CDNOA8DBKA5CGEA7DBFACA5CDFA7CA3GB5FGEA7GB2OB8FA146_a9ka21b2dca16ba13fa5bafea10ga5ba13ba5ba13b7a168',//haunted
            'A26MA19CA14DB4HB7EA6CA4DB7FA6CA4GB3EA10GB3EA4CA14LA4LA149_a26ha19fa14b5ga14ba19ba19b4da4fa14ca4ea149',//pan
            'A30NB2EA19CA16DBNKA16GBECA8DB5NB2OFCA8GB4EA5CA13LANB3FA146_a30ha22fa19ga19ba19ba13fa5ba13eacdb3a146',//pooh
            'A13NEA17DECA17C3A6NB8EACGFA15JBKA8NB8FACDEA17CLCA17GFCA18BFA125_a13ha47efa28gfa8cdb8ab3a17b3a17b3a18hba125',//space
            'A30NEA19CA9DB9KA9GB7EACA9DB7FACA9GB3EA5CA13CANB3FA148_a30ha20fa19ga19ba19ba13fa5ba13eacdb3a148',//princess
            'A44DB2OA16JB9EA9CADB7FA9CAGB7EA9LA5DB3FA9GB3OALA149_a44fa2ha16ga19ba19ba19ba19b3dcaea149',//mickey
            'A2MA7MA11C2A5C2A11C2A5C2A11C2A5C2A11CGB2IB2FCA11GB2EJNB2FA14C2A18C2A18C2A18GFA53_a2ea7ca11fha5hda19ba19ba15fa3ba15gb4a129',//dumbo
            'A2DB3EA15CA3CA15CA3GB5EA9CA2B3IBEACA9GBEA3CAGBFA11CA3GEA14GB3ECA15DB2FCA15MADBFA15CACA17LACA32_a65hafga19ba19b2a19ba19ba17b3a15fada17eaca32',//btm
            'A45DB2EA16CDBHB2EA9NB3FCA4CA14MA4CA9NB4FA4CA16DB2FA16CA19LA51_a66b2gfa11efa3ba19ba14cdb4a61ha51',//barn_fp_bottom
//              'A45DB2EA16CDBHB2EA9NB3FCA4CA14MA4CA9NB4FA4CA16DB2FA16CA19LA51_a45b4a16ba2gfa11cdb3a35efa65ha51',//barn_fp_top
//              'A21NBEA19CA19GB8EA19CA19CA19LA167_a21ka44fgb5a19ba19da19ca167',//rockin
            '',
            ''
          ];
          var nextMap = function () {
            tiles.reset(maps[++nextMap.index] || maps[nextMap.index = 0]);
            var name = names[nextMap.index];
            subway.setAttribute('for', name);
            counts.update(name);
          };
          nextMap.index = -1;
          setTimeout(function () {
            nextMap();
          }, 100);
          var controls = document.querySelector('#controls');
          var link = function (text, func, className) {
            var a = document.createElement('a');
            a.className = 'white button ' + (className || text);
            a.appendChild(document.createTextNode(text));
            a.addEventListener('click', func, false);
            controls.appendChild(a);
            return a;
          };
          link('next', nextMap);
          /*link('hide', function() {
            var qcs = document.querySelector('#queue_counters');
            qcs.classList.add('shown');
            setTimeout(function() {
              var move = function() {
                document.querySelector('#queue_counters').classList.remove('shown');
                qcs.removeEventListener('mousemove', move, false);
              };
              qcs.addEventListener('mousemove', move, false);

            }, 1200);
            document.body.classList.add('hide_subway_panel');
          });*/
          /*link('blank', tiles.reset);
          *//*link('edit', function () {
            this.classList.toggle('on');
            subway.classList.toggle('lines');
          }).setAttribute('title', 'shift to delete, \nalt to tweak, \napple/control to place object');//*/
          link('maps', function () {
//            this.classList.toggle('on');
            document.body.classList.toggle('thumbs');
          });
          (function () {
            window.subways = {};
            var thumbs = document.createElement('div');
//            <div class="close" onclick="document.body.classList.add('hide_subway_panel');">&times;</div>
            thumbs.classList.add('thumbs');
            var hr = document.createElement('hr');
            hr.classList.add('clear');
            thumbs.appendChild(hr);
            var base = document.createElement('div');
            base.classList.add('thumb');
            maps.forEach(function(map, i) {
              subways[names[i]] = map;
              var c = base.cloneNode(true);
              tiles.reset(map);
              subway.setAttribute('for', names[i]);
              c.setAttribute('for', names[i]);
              c.appendChild(subway.cloneNode(true));
              thumbs.insertBefore(c, thumbs.lastChild);
              c.addEventListener('click', function(e) {
                tiles.reset(map);
                subway.setAttribute('for', names[i]);
                if (!e.shiftKey) {
                  document.body.classList.remove('thumbs');
                  document.querySelector('#controls a.thumbs').classList.remove('on');
                }
                e.stopPropagation();
                e.preventDefault();
              }, true);
            });
            (function () {
              var close = document.createElement('div');
              close.innerHTML = '&times;';
              close.classList.add('close');
              close.addEventListener(touch, function() {
                document.body.classList.remove('thumbs');
              }, false);
              thumbs.appendChild(close);
            })();
            document.body.appendChild(thumbs);

          })();
        })();
      })();
    })();
    </script>

  </div>

  <footer>
  </footer>

</div>
<!--<script type='text/javascript' src='http://getfirebug.com/releases/lite/1.2/firebug-lite-compressed.js'></script>-->
<script>
  (function() {
    window.nav = {
      click: function(e) {
        var current = document.querySelector('nav a.selected');
        var a = this;
        if (current !== a) {
          var remove = current && current.classList.remove('selected');
          a.classList.add('selected');
          var value = a.getAttribute('for');
          var map = {
            'entitlements': entitlements,
            'blue': blue,
            'guest': { load: function() {
              guests.fetch('now', false, function(data) {
//                console.log('gl', data);
                var gt = document.querySelector('#guests_target');
                guests.load(gt, data.data.data);
                gt.classList.add('shown');
              });
            }}
          };
          window.currentView = map[value] || exec;
          currentView.load(tab.selected());
          ['entitlements', 'blue'].forEach(function(item) {
            var slide = (value === item) ? '0' : '1100';
            var z = (value === item) ? '18' : '17';
            var element = document.getElementById(item);
            element.style.webkitTransform = 'translate3d(' + slide + 'px, 0, 0)';
            element.style.mozTransform = 'translate(' + slide + 'px, 0)';
            element.style.zIndex = z;
          });
//                  wrap.setAttribute('tab', a.getAttribute('for') || '');
        }
      }
    };
    var wrap = document.body.querySelector('div.wrap');
    Array.forEach(document.body.querySelectorAll('nav a'), function(a) {
      a.addEventListener(touch, nav.click, false)
    });
  })();
//  remoteData({"status":"success","msgTimeStamp":1334005011209,"data":{"calendar":[[1190,1428],[390,1028],[220,5000],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[263,263],[2157,2157],[3100,3100],[0,0],[10141,10141],[36204,36204],[19700,19700],[18397,18397],[6044,6044],[5032,5032],[0,0],[0,0]]}});
//remoteData({"status":"success","msgTimeStamp":1334080586315,"data":{"calendar":[[7235,6386],[1949,1190],[0,0],[8747,5032],[8696,6044],[21235,18397],[33979,19700],[64288,36204],[10220,10141],[0,0],[5835,3100],[3770,2157],[376,263],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]]}});
(function (){
  var local;
//local = true;
  if (local) {
    remoteData({"status":"success","msgTimeStamp":1334080748461,"data":{"calendar":[[5675,6810],[990,1428],[0,0],[5032,7233],[6044,11096],[18397,19834],[19700,37317],[36204,36901],[10141,18983],[0,0],[3100,4732],[2157,2604],[263,447],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]]}});
//    remoteData({"status":"success","msgTimeStamp":1334079651221,"data":{"yesterday":{"selected":1428,"redeemed":990,"guests in queue":477,"participants":1667, "selected_offerset":[878,2580,2764,588],"redeemed_offerset":[732,2150,2303,490]},"today":{"selected":6810,"redeemed":5675,"guests in queue":1016,"participants":6135, "selected_offerset":[878,2580,2764,588],"redeemed_offerset":[732,2150,2303,490]}}});
//    remoteData({"status":"success","msgTimeStamp":1334925554578,"data":{"yesterday":{"selected":4,"selected_offerset":[1,1,0,2],"redeemed":4,"redeemed_offerset":[1,1,0,2],"guests in queue":0,"participants":2},"today":{"selected":0,"selected_offerset":[0,0,0,0],"redeemed":0,"redeemed_offerset":[0,0,0,0],"guests in queue":0,"participants":0},"date":"today"}});
//    remoteData({"status":"success","msgTimeStamp":1334944938015,"data":{"yesterday":{"selected":0,"selected_offerset":[0,0,0,0],"redeemed":0,"redeemed_offerset":[0,0,0,0],"guests in queue":0,"participants":0},"today":{"selected":6,"selected_offerset":[0,1,2,3],"redeemed":5,"redeemed_offerset":[0,1,1,3],"guests in queue":0,"participants":6},"date":"today"}});
    remoteData({"status":"success","msgTimeStamp":1334945637007,"data":{"yesterday":{"selected":0,"selected_offerset":[0,0,0,0],"redeemed":0,"redeemed_offerset":[0,0,0,0],"guests in queue":0,"participants":0},"today":{"selected":6,"selected_offerset":[2,1,0,3],"redeemed":5,"redeemed_offerset":[2,1,0,2],"guests in queue":0,"participants":6},"date":"today"}});
  } else {
    exec.fetch('today');
//    exec.fetch('now');
    setTimeout(function() {
      exec.fetch('cal/' + calendar.date.toString(calendar.future));
      setTimeout(function() {
//        entitlements.fetch('today');
      }, 3500);
    }, 0);
    (function () {
      var now = function() {
        setTimeout(now, 5000);
        exec.fetch('now', false);
      };
      window.now = now;
      window.stopTime = function() {
        now = function() {};
        exec.fetch = function() {};
      };
    })();
  }
})();
  /*entitlements.remote({"status":"success","msgTimeStamp":1334433983016,
    "data":{
      "dataHeader":["Facility","Guests In Queue","Available Entitlement","Selected Entitlement","Redeemed Entitlements","Total Blue Occurrences"],
      "data":[
        {"attraction":"Space Mountain","attractionId":8001019,"hour":0,"guestsInQueue":189,"availableEntitlements":-1,"selectedEntitlements":320,"redeemedEntitlements":200,"totalBlueLane":5,"overridesBlueLane":0},
        {"attraction":"Splash Mountain","attractionId":80010192,"hour":0,"guestsInQueue":189,"availableEntitlements":-1,"selectedEntitlements":270,"redeemedEntitlements":250,"totalBlueLane":5,"overridesBlueLane":0},
        {"attraction":"Buzz Lightyear\u0027s Space Ranger Spin","attractionId":80010114,"hour":0,"guestsInQueue":189,"availableEntitlements":-1,"selectedEntitlements":120,"redeemedEntitlements":100,"totalBlueLane":5,"overridesBlueLane":0},
        {"attraction":"Mickey Mouse at Town Square Theater","attractionId":15850196,"hour":0,"guestsInQueue":189,"availableEntitlements":-1,"selectedEntitlements":120,"redeemedEntitlements":100,"totalBlueLane":5,"overridesBlueLane":0},
        {"attraction":"Disney Princesses at Town Square Theater","attractionId":15850198,"hour":0,"guestsInQueue":189,"availableEntitlements":-1,"selectedEntitlements":400,"redeemedEntitlements":360,"totalBlueLane":5,"overridesBlueLane":0},
        {"attraction":"Peter Pan\u0027s Flight","attractionId":8001017,"hour":0,"guestsInQueue":189,"availableEntitlements":-1,"selectedEntitlements":120,"redeemedEntitlements":100,"totalBlueLane":5,"overridesBlueLane":0},
        {"attraction":"Jungle Cruise","attractionId":80010153,"hour":0,"guestsInQueue":189,"availableEntitlements":-1,"selectedEntitlements":120,"redeemedEntitlements":100,"totalBlueLane":5,"overridesBlueLane":0},
        {"attraction":"Mickey\u0027s PhilharMagic","attractionId":8001017,"hour":0,"guestsInQueue":189,"availableEntitlements":-1,"selectedEntitlements":120,"redeemedEntitlements":100,"totalBlueLane":5,"overridesBlueLane":0},
        {"attraction":"Haunted Mansion","attractionId":80010208,"hour":0,"guestsInQueue":189,"availableEntitlements":-1,"selectedEntitlements":220,"redeemedEntitlements":210,"totalBlueLane":5,"overridesBlueLane":0},
        {"attraction":"The Many Adventures of Winnie the Pooh","attractionId":80010213,"hour":0,"guestsInQueue":189,"availableEntitlements":-1,"selectedEntitlements":120,"redeemedEntitlements":100,"totalBlueLane":5,"overridesBlueLane":0}]
    }});*/
</script>
<style>
  #get_chrome_frame {
    position: absolute;
    top: 0;
    left: 0;
    z-index: 14000;
    background-color: black !important;
    color: white !important;
    width: 100% !important;
    height: 1500px !important;
  }
  #get_chrome_frame a {
    position: absolute;
    top: 400px;
    left: 200px;
    text-align: center;
    margin: auto;
    color: white !important;
    font-size: 2em;
    font-family: helvetica, sans-serif;
  }

</style>
<!--[if IE]>
<div id="get_chrome_frame"><a href="ie.html" target="_blank">This page requires a component that you do not have.<br /><br /><br /><span>Please click <span style="text-decoration: underline;">here</span> to continue.</span></a></a></div>
<![endif]-->
<style>
  #get_chrome_frame {
    -webkit-transform: translate3d(-15000px, -15000px, 0);
  }
</style>
<script>
  (function (){
    var dictionary = [];
    dictionary[2] = 'Executive Summary	Redeemed	Based on GxP Logic.  Count of entitlements tapped at the merge point.';
    dictionary[3] = 'Executive Summary	Selected	Based on GxP Logic.  Count of entitlements selected by a guest.';
    dictionary[4] = 'Executive Summary	% Redeemed	Redeemed entitlements over Selected entitlements';
    dictionary[5] = 'Executive Summary	Test Participants	Count of guests that have entitlements for the day';
    dictionary[6] = 'Executive Summary	Currently in Queue	Count of guests that are between Entry and Merge for all attractions';
    dictionary[7] = 'Executive Summary	Offersets Redeemed	Count of entitlements tapped at the merge point, by Offerset';
    dictionary[8] = 'Executive Summary	Offersets Selected	Count of entitlements selected, by Offerset';
    dictionary[9] = 'Executive Summary	Offersets Bar Graph	Redeemed entitlements over Selected entitlements';
    dictionary[10] = 'Executive Summary: Select Date	Screen	Allows the user to select a date in the past and see data associated.  The donut progress bar displayed around the data represents the % Redeemed for the date.';
    dictionary[11] = 'Executive Summary: To Date	Screen	The summation of data to the current point in time';
    dictionary[12] = 'Entitlements 	Redeemed	Based on GxP Logic.  Guests who tap at the merge point and thus send a RED message to GxP.';
    dictionary[13] = 'Entitlements	 Selected	Based on GxP Logic.  Count of entitlements selected within an offerset.  SEL meesage sent to GxP';
    dictionary[14] = 'Entitlements	 Bar Graph	Redeemed entitlements over Selected entitlements';
    dictionary[15] = 'Entitlements	 Attraction List: Bar Graph	Redeemed entitlements over Selected entitlements by attraction';
    dictionary[16] = 'Entitlements	 Attraction Chart	Attraction specific metrics by hour.  Displays quests in queue, Redeemed, Selected, Blue Lanes and Overrides';
    dictionary[17] = 'Entitlements	 Guest List by Hour	Displays the guests (by email and guest ID) who have redeemed within that hour';
    dictionary[18] = 'Entitlements	 Guest Window: Entitlements	All the entitlements that are assigned to that guest.';
    dictionary[19] = 'Entitlements 	Guest Window: Reads	Every location (xPass Entry & Merge) where a guest is seen';
    dictionary[20] = 'Entitlements	 Guest Window: Experiences	Displays the wait time the guest experienced at each attraction.  Wait time is calculated by subtracting the Merge Timestamp by the xPassEntry Timestamp';
    dictionary[21] = 'Blue Lanes	Occurances	Count of Blue Lane occurances';
    dictionary[22] = 'Blue Lanes	Overrides	Count of Overrides.';
    dictionary[23] = 'Blue Lanes	Bar Graph	Overrides over Occurances';
    dictionary[24] = 'Blue Lanes	Reasons	When a cast member Overrides a guest, they assign a Reason for the Override.  This window shows the counts of Overrides by the reason for the Override';
    dictionary[25] = 'Recruiting	Recruited	Number of guests recruited to participate in the Test';
    dictionary[26] = 'Recruiting	Target	Target number of guests as specified by Disney';
    dictionary[27] = 'Recruiting	DME Guests	Guests approached by DME';
    dictionary[28] = 'Recruiting	Recruited %	Recruited over Target';


    var binds = document.querySelectorAll('*[bind]');
    Array.forEach(binds, function(bind) {
      bind.setAttribute('desc', dictionary[bind.getAttribute('num') * 1]);
    });
  })();
</script>
<script>
  (function () {
    var shuffle = function(text) {
      var characters = text.match(/./g);
      return characters.sort().join('');
    };
    window.ob = function() {
      Array.forEach(document.getElementsByTagName('*'), function(element) {
        Array.forEach(element.childNodes, function(node) {
          if (node.nodeName === '#text' && element.offsetHeight && (node.nodeValue || '').length > 4) {
            node.nodeValue = shuffle(node.nodeValue);//(node.nodeValue || '').replace(/[A-Za-z]/g, '*');
//            console.log(node.nodeValue);
          }
        });
      });
    };
  })();
//  setTimeout(ob, 200);
//  setTimeout(ob, 1000);
//  setTimeout(ob, 2000);
  /*setTimeout(function() {
    window.busters = window.busters || {};
    busters.foo = function(data) {
      config.facilities.render(data);
    };
    //remoteData({"status":"success","msgTimeStamp":1343021768142,"buster":"foo","data":{"facilities":{"80010213":{"facilityId":"80010213","name":"Adventures of Winnie the Pooh","shortName":"POOH"},"80010153":{"facilityId":"80010153","name":"Jungle Cruise","shortName":"JUNGLE"},"00000001":{"facilityId":"00000001","name":"FakeFacility1","shortName":"FF1"},"80010110":{"facilityId":"80010110","name":"Big Thunder Mountain","shortName":"BTM"},"15850196":{"facilityId":"15850196","name":"Mickey Town Square Theater","shortName":"MTST"},"80010114":{"facilityId":"80010114","name":"Buzz Lightyears Space Ranger Spin","shortName":"BUZZ"},"80010190":{"facilityId":"80010190","name":"Space Mountain","shortName":"SPAMTN"},"80010192":{"facilityId":"80010192","name":"Splash Mountain","shortName":"SPLMTN"},"80010170":{"facilityId":"80010170","name":"Mickeys PhilharMagic","shortName":"PHILH"},"16491297":{"facilityId":"16491297","name":"Barnstormer","shortName":"BARN"},"80010208":{"facilityId":"80010208","name":"Haunted Mansion","shortName":"HMANS"},"80010176":{"facilityId":"80010176","name":"Peter Pans Flight","shortName":"PPAN"},"15850198":{"facilityId":"15850198","name":"Princesses Town Square Theater","shortName":"PTST"},"80010129":{"facilityId":"80010129","name":"Dumbo","shortName":"DMBO"}}},"dates":{}});
  }, 700);*/
</script>
<script>
  setTimeout(function() {
//      var base = 'http://10.1.50.179:8080';
//      var base = 'http://sparklepony.local:8080';
    var base = '';
    var s = document.createElement('script');
    var file = (/1\/[\w\.]+$|[\w\.]+$|1\/$/.exec(location.pathname) || [''])[0];
    console.log(encodeURIComponent(file));
    if (!/\.html/.test(file)) {
      file += 'index.html';

    }
    s.src = base + '/xi/dashboard/page/guidcheck/' + encodeURIComponent(file) + '/' + (window.guid || 'no-guid') + '?buster=' + (new Date() *1);
    document.head.appendChild(s);
  }, 1000);
</script>
</body>
</html>

<script>(function(){window.guid = 'fa478e7a-d9a0-11e1-ab8c-b8f6b118fdfb';})();</script>

<script>(function(){window.guid = 'fa478e7a-d9a0-11e1-ab8c-b8f6b118fdfb';})();</script>